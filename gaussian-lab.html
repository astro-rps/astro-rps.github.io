<!DOCTYPE html><html lang="en" class="light" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Astro RPS</title><link rel="stylesheet" href="/build/_assets/app-LVHQOBTF.css"/><link rel="stylesheet" href="/build/_assets/thebe-core-SJEQ5G4L.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 fixed w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-wrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center"><div class="block xl:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 013.75 6h16.5a.75.75 0 010 1.5H3.75A.75.75 0 013 6.75zM3 12a.75.75 0 01.75-.75h16.5a.75.75 0 010 1.5H3.75A.75.75 0 013 12zm0 5.25a.75.75 0 01.75-.75h16.5a.75.75 0 010 1.5H3.75a.75.75 0 01-.75-.75z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/"><div class="p-1 mr-3 dark:bg-white dark:rounded"><img src="/build/astro-rps-logo-5e1744e2e1dba761340324e371f9a0e6.webp" class="h-9" alt="Astro RPS" height="2.25rem"/></div><span class="text-md sm:text-xl tracking-tight sm:mr-5 sr-only">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button class="theme rounded-full border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Change theme to dark mode." aria-label="Change theme to dark mode."><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="h-full w-full p-0.5"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><div class="fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><nav aria-label="Table of Contents" class="flex-grow overflow-y-auto transition-opacity mt-6 pb-3 ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white"><a title="Astro RPS" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/">Astro RPS</a><a title="Course Topics" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/topiclist">Course Topics</a><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Lectures" class="block break-words rounded py-2 grow cursor-pointer">Lectures</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" type="button" aria-controls="radix-:R3d8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R3d8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="open" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Labs" class="block break-words rounded py-2 grow font-semibold text-blue-800 dark:text-blue-200 cursor-pointer">Labs</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" type="button" aria-controls="radix-:R4d8p:" aria-expanded="true" data-state="open"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="open" id="radix-:R4d8p:" class="pl-3 pr-[2px] collapsible-content"><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Week  1" class="block break-words rounded py-2 grow cursor-pointer">Week  1</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" type="button" aria-controls="radix-:R3cd8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R3cd8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Week  2" class="block break-words rounded py-2 grow cursor-pointer">Week  2</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" type="button" aria-controls="radix-:R5cd8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R5cd8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Week  3" class="block break-words rounded py-2 grow cursor-pointer">Week  3</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" type="button" aria-controls="radix-:R7cd8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R7cd8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Week  4" class="block break-words rounded py-2 grow cursor-pointer">Week  4</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" type="button" aria-controls="radix-:R9cd8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R9cd8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Week  5" class="block break-words rounded py-2 grow cursor-pointer">Week  5</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" type="button" aria-controls="radix-:Rbcd8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rbcd8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Week  6" class="block break-words rounded py-2 grow cursor-pointer">Week  6</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" type="button" aria-controls="radix-:Rdcd8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rdcd8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Week  7" class="block break-words rounded py-2 grow cursor-pointer">Week  7</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" type="button" aria-controls="radix-:Rfcd8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rfcd8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="open" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Week  8" class="block break-words rounded py-2 grow font-semibold text-blue-800 dark:text-blue-200 cursor-pointer">Week  8</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" type="button" aria-controls="radix-:Rhcd8p:" aria-expanded="true" data-state="open"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="open" id="radix-:Rhcd8p:" class="pl-3 pr-[2px] collapsible-content"><a title="Fitting Models to Data: Bootstrapping" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/bootstrapping-lab">Fitting Models to Data: Bootstrapping</a><a title="Moving beyond polynomials: Fitting arbitrary functions" aria-current="page" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg bg-blue-300/30 active" href="/gaussian-lab">Moving beyond polynomials: Fitting arbitrary functions</a></div></div></div></div></div></nav><div class="flex-none py-4 transition-all duration-700 translate-y-6 opacity-0"><a class="flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><article class="article content article-grid grid-gap" style="margin-top:60px"><main class="article-grid subgrid-gap col-screen"><div class="sticky z-10 hidden h-0 col-margin-right-inset lg:block" style="top:60px"><nav></nav></div><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="pt-5 mb-8"><div class="flex items-center h-6 mt-3 mb-5 text-sm font-light"><div class="flex-grow"></div><a href="https://github.com/https://astro-rps.github.io/" title="GitHub Repository: https://astro-rps.github.io/" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><div class="inline-block mr-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block"><path d="M20.2 1.7c0 .8-.5 1.4-1.3 1.5-.8 0-1.4-.5-1.5-1.3 0-.8.5-1.4 1.3-1.5.8-.1 1.5.5 1.5 1.3zM12 17.9c-3.7 0-7-1.3-8.7-3.3 1.8 4.8 7.1 7.3 11.9 5.5 2.5-.9 4.5-2.9 5.5-5.5-1.7 2-4.9 3.3-8.7 3.3zM12 5.1c3.7 0 7 1.3 8.7 3.3-1.8-4.8-7.1-7.3-11.9-5.5-2.5.9-4.5 2.9-5.5 5.5 1.7-2 5-3.3 8.7-3.3zM6.9 21.8c.1 1-.7 1.8-1.7 1.9-1 .1-1.8-.7-1.9-1.7 0-1 .7-1.8 1.7-1.9 1-.1 1.8.7 1.9 1.7zM3.7 4.6c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1c0 .5-.4 1-1 1z"></path></svg></div><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative" id="headlessui-menu-button-:R1khtop:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="ml-2 -mr-1"><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="mb-0">Moving beyond polynomials: Fitting arbitrary functions</h1></div><div id="skip-to-article"></div><div id="hLHjlrTiYt" class="relative group/block article-grid subgrid-gap col-screen"><p>In some cases, the relationship between variables in our data may not be well described by a simple polynomial function. When this happens, we need to use more flexible methods that allow us to fit arbitrary functions to our data. One such method is the <code>curve_fit</code> function from the SciPy library, which enables us to fit user-defined functions to our data using non-linear least squares optimization.</p><h2 id="using-curve-fit-in-scipy" class="relative group"><span class="heading-text">Using <code>curve_fit</code> in SciPy:</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#using-curve-fit-in-scipy" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>The <code>curve_fit</code> function in SciPy is a powerful tool for fitting arbitrary functions to data using non-linear least squares optimization. It takes as input a user-defined model function, along with the observed data and optional initial parameter estimates, and returns the optimal parameter values that minimize the sum of squared residuals between the model predictions and the observed data.</p><h3 id="example-fitting-a-line-to-the-m-sigma-relation-using-curve-fit" class="relative group"><span class="heading-text">Example: Fitting a Line to the M-sigma Relation using <code>curve_fit</code></span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#example-fitting-a-line-to-the-m-sigma-relation-using-curve-fit" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="CxWIqa99LB" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># First, copy our code from last time to read in the m-sigma data and fit a line with polyfit
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

df = pd.read_csv(&#x27;m-sigma.txt&#x27;)
log_BH = np.log10(df.M_bh)
BH_err = df.M_bh_err

coefficients = np.polyfit(df.sigma,log_BH,deg=1,w=1/BH_err)
x_fit = np.linspace(50,400,100)
y_fit = np.polyval(coefficients, x_fit)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="A5m3zbsc6a-4q41PURVLY" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="d5sFePFgHv" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">from scipy.optimize import  curve_fit

# Define a linear model function (y = mx + b)
def linear_model(x, m, b):
    return m * x + b

# Perform curve fitting to estimate parameters (slope and intercept)
popt, pcov = curve_fit(linear_model, df.sigma, log_BH)

# Extract estimated parameters
slope, intercept = popt</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="2UMT01j-w7dBaYkaQUl_X" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="iqSWbGx38O" class="relative group/block article-grid subgrid-gap col-screen"><p>We usually call the outputs of <code>curve_fit</code> <code>popt</code> and <code>pcov</code>. These represent:</p><ul><li><code>popt</code>: This variable holds the best estimates of the parameters (e.g., slope and intercept) for the fitted model. It’s what we use to get the actual values of the parameters we’re interested in. The ordering of <code>popt</code> matches the ordering of the paramters in our <code>linear_model</code> user defined function after the first arguement (which is the data x).</li><li><code>pcov</code>: This variable represents the covariance matrix, which tells us about the uncertainty or correlation between the estimated parameters. It helps us understand how reliable our parameter estimates are. Specifically, it provides information about how much the estimated parameters vary together. If two parameters are highly correlated, changes in one may influence the estimate of the other. For now, we can ignore this.</li></ul></div><div id="hHqKORcNKS" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">fig, ax = plt.subplots(figsize=(7,7))
ax.errorbar(df.sigma, log_BH, yerr=BH_err, xerr=df.sigma_err, fmt=&#x27;None&#x27;, color=&#x27;gray&#x27;)
ax.plot(df.sigma, log_BH, &#x27;s&#x27;, color=&#x27;blue&#x27;, ms=12, alpha=0.5, mec=&#x27;k&#x27;)

ax.plot(x_fit, y_fit, &#x27;k&#x27;, lw=3, label = &#x27;Polyfit Line&#x27;)
ax.plot(df.sigma, linear_model(df.sigma, slope, intercept), color=&#x27;red&#x27;, label=&#x27;Curve Fit Line&#x27;)

ax.set_xlabel(&#x27;Velocity Dispersion [km/s]&#x27;, fontsize=16)
ax.tick_params(which=&#x27;both&#x27;, top=True, right=True, direction=&#x27;in&#x27;, length=6)
ax.set_ylabel(r&#x27;log M$_{\rm BH}$ [$M_{\odot}$]&#x27;, fontsize=16)
ax.legend();</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="7ceaGzdFzHjk3NeJFNOKY" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/build/46f570c564be7aa375dbfc93afe19fc1.png" alt="&lt;Figure size 700x700 with 1 Axes&gt;"/></div></div><div id="y63ZEt0Oll" class="relative group/block article-grid subgrid-gap col-screen"><p>Note: these fits may be slightly different because we are not incorporating errors in the fit using <code>curve_fit</code>.</p></div><div id="RMnnUKk4sK" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="a-common-use-case-gaussian-fitting" class="relative group"><span class="heading-text">A Common Use-Case: Gaussian Fitting</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#a-common-use-case-gaussian-fitting" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Gaussian fitting, also known as Gaussian curve fitting or Gaussian distribution fitting, is a statistical method used to model data that follows a Gaussian (normal) distribution. A Gaussian distribution is characterized by its bell-shaped curve, which is symmetrical around the mean and describes the probability distribution of a continuous random variable. Gaussian fitting involves estimating the parameters of a Gaussian function, such as the mean, standard deviation, and amplitude, that best describe the observed data.</p><p>Gaussian fitting is important in many aspects of astronomy, as we expect many distributions to be well-described by Gaussians. A
Gaussian can be expressed as:
</p><div id="EQr0EhYtmt" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>A</mi><mo>⋅</mo><msup><mi>e</mi><mrow><mo>−</mo><mfrac><mrow><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><mi>μ</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><mrow><mn>2</mn><msup><mi>σ</mi><mn>2</mn></msup></mrow></mfrac></mrow></msup></mrow><annotation encoding="application/x-tex"> f(x) = A \cdot e^{-\frac{(x - \mu)^2}{2\sigma^2}} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.3291em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.3291em;"><span style="top:-3.4534em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.251em;"><span style="top:-2.5062em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9384em;"><span style="top:-2.9384em;margin-right:0.1em;"><span class="pstrut" style="height:2.6444em;"></span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.2255em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.5021em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">μ</span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0484em;"><span style="top:-3.0484em;margin-right:0.1em;"><span class="pstrut" style="height:2.6444em;"></span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4938em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="select-none no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit hover:underline" href="#EQr0EhYtmt" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->1<!-- -->)</a></div></div><ul><li><strong>Mean (μ)</strong>: The center or average value of the Gaussian distribution.</li><li><strong>Standard Deviation (σ)</strong>: The measure of the spread or dispersion of the Gaussian distribution.</li><li><strong>Amplitude (A)</strong>: The peak height or maximum value of the Gaussian curve.</li></ul></div><div id="bYjVOCNvEX" class="relative group/block article-grid subgrid-gap col-screen"><aside class="my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden rounded border-l-4 border-green-600"><div class="m-0 font-medium py-1 flex min-w-0 text-lg text-green-600 bg-green-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="2rem" height="2rem" class="inline-block pl-2 mr-2 self-center flex-none text-green-600"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"></path></svg><div class="text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Exercise 1: Fitting a Gaussian to Synthetic Data</div></div><div class="px-4 py-1"><p>Using the <code>curve_fit</code> function, fit a Gaussian function to the noisy data provided below and estimate the parameters that best describe the underlying Gaussian distribution.</p><ol start="1"><li><p><strong>Copy the starter code below</strong>: Begin by copying the starter code to generate synthetic data representing noisy measurements of a Gaussian distribution. The data consists of input values (<code>x</code>) and corresponding noisy observations (<code>y_noise</code>).</p></li><li><p><strong>Define the Gaussian Model Function</strong>: Define a Gaussian model function representing the mathematical form of a Gaussian distribution. The Gaussian function should take input variables (e.g., <code>x</code>) and parameters (e.g., mean, standard deviation, amplitude) as arguments and return the predicted values of the Gaussian distribution.</p></li><li><p><strong>Perform Curve Fitting</strong>: Use the <code>curve_fit</code> function from the SciPy library to fit the Gaussian model function to the noisy data. Provide the input data (<code>x</code>) and noisy observations (<code>y_noise</code>) as input arguments to <code>curve_fit</code>. Optionally, you can provide initial estimates for the parameters to aid the fitting process. Look at the <code>curve_fit</code> documentation to see how to do this!</p></li><li><p><strong>Visualize the Fitted Gaussian</strong>: Plot the noisy data along with the fitted Gaussian distribution to visualize how well the Gaussian model fits the observed data.</p></li></ol></div></aside></div><div id="X7Ae6bp0zn" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import curve_fit

# Generate synthetic data following a Gaussian distribution
x = np.linspace(-5, 5, 100)
y_true = np.exp(-0.5 * (x ** 2)) / np.sqrt(2 * np.pi)  # True Gaussian distribution

# Add noise to the data to simulate experimental measurements
np.random.seed(0)
y_noise = y_true + np.random.normal(loc=0, scale=0.1, size=len(x))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="5KqKxQ3aETwC1LCyhNt1b" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="ya0UcDHcau" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">fig, ax = plt.subplots(figsize=(7,7))
ax.scatter(x, y_noise, color=&#x27;blue&#x27;, label=&#x27;Noisy Data&#x27;)
ax.plot(x, y_true, linestyle=&#x27;--&#x27;, color=&#x27;green&#x27;, label=&#x27;True Gaussian Distribution&#x27;)
ax.set_xlabel(&#x27;x&#x27;, fontsize=14)
ax.set_ylabel(&#x27;y&#x27;, fontsize=14)
ax.tick_params(which=&#x27;both&#x27;, top=True, right=True, direction=&#x27;in&#x27;, length=6)
ax.legend();</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="i6O2-Zy1dSTbOgW3LW7vN" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/build/0ce15aaf9cea92070116704b3997f417.png" alt="&lt;Figure size 700x700 with 1 Axes&gt;"/></div></div><div id="e5DNR7gUki" class="relative group/block article-grid subgrid-gap col-screen"><aside class="my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden rounded border-l-4 border-green-600"><div class="m-0 font-medium py-1 flex min-w-0 text-lg text-green-600 bg-green-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="2rem" height="2rem" class="inline-block pl-2 mr-2 self-center flex-none text-green-600"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"></path></svg><div class="text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Exercise 2: Fitting a Gaussian to a Real Galaxy Spectrum!</div></div><div class="px-4 py-1"><p>On slack, we will send a data file with a galaxy spectrum that has the columns <code>wave</code>, <code>flux</code>, and <code>ivar</code>. These stand for the wavelength array (which you would plot on the x-axis), the flux or intensity of emission at every given wavelength (which you would plot on the y-axis), and the inverse variance for each flux measurement.</p><p>Load in this data, and slice the arrays to select for the H-alpha emission line (this is the largest emission line in this spectrum). Then, using your Gaussian fitting code to fit a Gaussian to the H-alpha line and report the line center and line width.</p></div></aside></div><div class="flex pt-10 mb-10 space-x-4"><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/bootstrapping-lab"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="text-xs text-gray-500 dark:text-gray-400">Week  8</div>Fitting Models to Data: Bootstrapping</div></div></a></div></main></article><script>((l,d)=>{if(!window.history.state||!window.history.state.key){let f=Math.random().toString(32).slice(2);window.history.replaceState({key:f},"")}try{let p=JSON.parse(sessionStorage.getItem(l)||"{}")[d||window.history.state.key];typeof p=="number"&&window.scrollTo(0,p)}catch(f){console.error(f),sessionStorage.removeItem(l)}})("positions", null)</script><link rel="modulepreload" href="/build/entry.client-K6EYMIDZ.js"/><link rel="modulepreload" href="/build/_shared/chunk-FBLNPC3V.js"/><link rel="modulepreload" href="/build/_shared/chunk-XJN3BT5Q.js"/><link rel="modulepreload" href="/build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="/build/_shared/chunk-JPGYAJQ3.js"/><link rel="modulepreload" href="/build/_shared/chunk-YAIQ7LUU.js"/><link rel="modulepreload" href="/build/_shared/chunk-JOLZ6LZB.js"/><link rel="modulepreload" href="/build/_shared/chunk-XIW7RL3H.js"/><link rel="modulepreload" href="/build/_shared/chunk-I634YBN3.js"/><link rel="modulepreload" href="/build/_shared/chunk-MITWS4PZ.js"/><link rel="modulepreload" href="/build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="/build/_shared/chunk-M5ZDOVXY.js"/><link rel="modulepreload" href="/build/_shared/chunk-6TYLRLOL.js"/><link rel="modulepreload" href="/build/_shared/chunk-UZHI4RYQ.js"/><link rel="modulepreload" href="/build/_shared/chunk-RTIGS2T3.js"/><link rel="modulepreload" href="/build/root-2CYAF5SQ.js"/><link rel="modulepreload" href="/build/_shared/chunk-OYK7WRH2.js"/><link rel="modulepreload" href="/build/routes/$-ZDWRJY4B.js"/><script>window.__remixContext = {"url":"/gaussian-lab","state":{"loaderData":{"root":{"theme":"light","config":{"title":"Astro RPS","options":{"logo":"/build/astro-rps-logo-5e1744e2e1dba761340324e371f9a0e6.webp"},"myst":"1.1.37","nav":[],"actions":[],"projects":[{"title":"Astro RPS","github":"https://astro-rps.github.io/","keywords":[],"thumbnail":"/build/astro-rps-header-git-a93200a8cc2b5d8ab2d12eb69452df7a.png","exports":[],"bibliography":[],"index":"readme","pages":[{"slug":"topiclist","title":"Course Topics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"title":"Lectures","level":1},{"title":"Week  1","level":2},{"slug":"intro","title":"Welcome to the Astro Research Preparation Series!","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"unix","title":"Introduction to UNIX and Filesystems: Navigating and Managing Data","description":"","date":"","thumbnail":"/build/finder-5c14a1ea67fb2a5082eb3c298369552b.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"environments","title":"The Python Ecosystem and Virtual Environments","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Week  2","level":2},{"slug":"first-python-codes","title":"First Python Codes","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"variables-datatypes","title":"A Deep Dive into Variables and Datatypes","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"numpy-and-arrays","title":"Numpy and Arrays","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Week  3","level":2},{"slug":"import-lecture","title":"Introduction to Imports","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"logic-lecture","title":"Logic Flow and Error Parsing","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"loop-lecture","title":"Looping in Python","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Week  4","level":2},{"slug":"functions","title":"Functions in Python","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Week  5","level":2},{"slug":"pandas","title":"Pandas","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Week  8","level":2},{"slug":"week8-linear-regression","title":"Introduction to Inference in Astronomy: Fitting Models to Data","description":"","date":"","thumbnail":"/build/bootstrap_resampling-19edf9abbf7bf206cfe7896795c20131.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Labs","level":1},{"title":"Week  1","level":2},{"slug":"hunt","title":"Unix Scavenger Hunt!","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Week  2","level":2},{"slug":"week2-assignment","title":"Calculating the Luminosities of Stars","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Week  3","level":2},{"slug":"assignment-w3","title":"Week 3 Assignment","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Week  4","level":2},{"slug":"week4","title":"Week 4 Exercises","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Week  5","level":2},{"slug":"assignment-functions","title":"Functions (and HII regions in M33)","description":"","date":"","thumbnail":"/build/eagle-ade9779fab06ef18b8a3a7eb705cc974.jpg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Week  6","level":2},{"slug":"week6-lab","title":"Astro-RPS Week 6 Lab: Practice with Notebook, Pandas, and Plotting!","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Week  7","level":2},{"slug":"rps-week7-exoplanets","title":"Astro-RPS Week 7 Lab:  Exploring the Diversity of Known Exoplanets","description":"","date":"","thumbnail":"/build/Mass-separation-plot-3ea344c33adb20b08be5a92a143f829e.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Week  8","level":2},{"slug":"bootstrapping-lab","title":"Fitting Models to Data: Bootstrapping","description":"","date":"","thumbnail":"/build/bootstrap_resampling-7ec0da12281d7c1bce988260308d21fe.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"gaussian-lab","title":"Moving beyond polynomials: Fitting arbitrary functions","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static"},"routes/$":{"page":{"kind":"Notebook","sha256":"5641b3efc94de68e007e26a26eeea750c562ba7b5d389257a250504cbc309da5","slug":"gaussian-lab","location":"/02_Labs/Week 8/gaussian_lab.ipynb","dependencies":[],"frontmatter":{"title":"Moving beyond polynomials: Fitting arbitrary functions","github":"https://astro-rps.github.io/","keywords":[],"exports":[{"format":"ipynb","filename":"gaussian_lab.ipynb","url":"/build/gaussian_lab-4c52e2440da2229cbeb3e0beadd98f58.ipynb"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In some cases, the relationship between variables in our data may not be well described by a simple polynomial function. When this happens, we need to use more flexible methods that allow us to fit arbitrary functions to our data. One such method is the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UdFDVLv0Bd"},{"type":"inlineCode","value":"curve_fit","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"anwQ41I9mY"},{"type":"text","value":" function from the SciPy library, which enables us to fit user-defined functions to our data using non-linear least squares optimization.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ML2Dl4PxXZ"}],"key":"jowwTjzVn1"},{"type":"heading","depth":2,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Using ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"qVcrSJjwK9"},{"type":"inlineCode","value":"curve_fit","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"hyvVP9wzxc"},{"type":"text","value":" in SciPy:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"y6H1gY9Rbj"}],"identifier":"using-curve-fit-in-scipy","label":"Using curve_fit in SciPy:","html_id":"using-curve-fit-in-scipy","implicit":true,"key":"hTJ5jxfdgw"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"r5dbJSpO3Y"},{"type":"inlineCode","value":"curve_fit","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"P2fbbi8lcV"},{"type":"text","value":" function in SciPy is a powerful tool for fitting arbitrary functions to data using non-linear least squares optimization. It takes as input a user-defined model function, along with the observed data and optional initial parameter estimates, and returns the optimal parameter values that minimize the sum of squared residuals between the model predictions and the observed data.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"G6H0iyhkdY"}],"key":"J2yJFum7Mt"},{"type":"heading","depth":3,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Example: Fitting a Line to the M-sigma Relation using ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"N8UCODTS5m"},{"type":"inlineCode","value":"curve_fit","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"LvCTh6nz2X"}],"identifier":"example-fitting-a-line-to-the-m-sigma-relation-using-curve-fit","label":"Example: Fitting a Line to the M-sigma Relation using curve_fit","html_id":"example-fitting-a-line-to-the-m-sigma-relation-using-curve-fit","implicit":true,"key":"nxDdi2XVUB"}],"data":{"type":"notebook-content"},"key":"hLHjlrTiYt"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"# First, copy our code from last time to read in the m-sigma data and fit a line with polyfit\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n\ndf = pd.read_csv('m-sigma.txt')\nlog_BH = np.log10(df.M_bh)\nBH_err = df.M_bh_err\n\ncoefficients = np.polyfit(df.sigma,log_BH,deg=1,w=1/BH_err)\nx_fit = np.linspace(50,400,100)\ny_fit = np.polyval(coefficients, x_fit)","key":"ZEmwlqfvyG"},{"type":"output","id":"A5m3zbsc6a-4q41PURVLY","data":[],"key":"x6h1pIWs90"}],"data":{"type":"notebook-code"},"key":"CxWIqa99LB"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.optimize import  curve_fit\n\n# Define a linear model function (y = mx + b)\ndef linear_model(x, m, b):\n    return m * x + b\n\n# Perform curve fitting to estimate parameters (slope and intercept)\npopt, pcov = curve_fit(linear_model, df.sigma, log_BH)\n\n# Extract estimated parameters\nslope, intercept = popt","key":"IL7nJlB1qn"},{"type":"output","id":"2UMT01j-w7dBaYkaQUl_X","data":[],"key":"hsVTeExynN"}],"data":{"type":"notebook-code"},"key":"d5sFePFgHv"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We usually call the outputs of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SA045VICol"},{"type":"inlineCode","value":"curve_fit","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xBqkasAXPO"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bprPXnUkWR"},{"type":"inlineCode","value":"popt","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rfKJSvSfCZ"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Op2lT6hF18"},{"type":"inlineCode","value":"pcov","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pKxQvzFHNl"},{"type":"text","value":". These represent:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fjtBpKR9se"}],"key":"tH6pJhdlhk"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"inlineCode","value":"popt","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Fo5rCWfypr"},{"type":"text","value":": This variable holds the best estimates of the parameters (e.g., slope and intercept) for the fitted model. It’s what we use to get the actual values of the parameters we’re interested in. The ordering of ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Ah6T38D2CA"},{"type":"inlineCode","value":"popt","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"xMEDFnP4Up"},{"type":"text","value":" matches the ordering of the paramters in our ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"s7CTffeUw8"},{"type":"inlineCode","value":"linear_model","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"mEAPutX40C"},{"type":"text","value":" user defined function after the first arguement (which is the data x).","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"X3MINVr1Dr"}],"key":"aRerqRmKQ9"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"inlineCode","value":"pcov","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VK2BehVLkx"},{"type":"text","value":": This variable represents the covariance matrix, which tells us about the uncertainty or correlation between the estimated parameters. It helps us understand how reliable our parameter estimates are. Specifically, it provides information about how much the estimated parameters vary together. If two parameters are highly correlated, changes in one may influence the estimate of the other. For now, we can ignore this.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uhAr6HC3XN"}],"key":"SzXoVmjzpO"}],"key":"j0Xhhkiuz8"}],"data":{"type":"notebook-content"},"key":"iqSWbGx38O"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(figsize=(7,7))\nax.errorbar(df.sigma, log_BH, yerr=BH_err, xerr=df.sigma_err, fmt='None', color='gray')\nax.plot(df.sigma, log_BH, 's', color='blue', ms=12, alpha=0.5, mec='k')\n\nax.plot(x_fit, y_fit, 'k', lw=3, label = 'Polyfit Line')\nax.plot(df.sigma, linear_model(df.sigma, slope, intercept), color='red', label='Curve Fit Line')\n\nax.set_xlabel('Velocity Dispersion [km/s]', fontsize=16)\nax.tick_params(which='both', top=True, right=True, direction='in', length=6)\nax.set_ylabel(r'log M$_{\\rm BH}$ [$M_{\\odot}$]', fontsize=16)\nax.legend();","key":"yTDvxUYWjJ"},{"type":"output","id":"7ceaGzdFzHjk3NeJFNOKY","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"46f570c564be7aa375dbfc93afe19fc1","path":"/build/46f570c564be7aa375dbfc93afe19fc1.png"},"text/plain":{"content":"\u003cFigure size 700x700 with 1 Axes\u003e","content_type":"text/plain"}}}],"key":"C0k3n8O1Io"}],"data":{"type":"notebook-code"},"key":"hHqKORcNKS"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Note: these fits may be slightly different because we are not incorporating errors in the fit using ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sNG5kvSl7v"},{"type":"inlineCode","value":"curve_fit","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bmO5WtENkK"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ih5hMIkk2p"}],"key":"krXXSU52v0"}],"data":{"type":"notebook-content"},"key":"y63ZEt0Oll"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"A Common Use-Case: Gaussian Fitting","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZjzKk2KIdE"}],"identifier":"a-common-use-case-gaussian-fitting","label":"A Common Use-Case: Gaussian Fitting","html_id":"a-common-use-case-gaussian-fitting","implicit":true,"key":"HZgXEQwr5x"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Gaussian fitting, also known as Gaussian curve fitting or Gaussian distribution fitting, is a statistical method used to model data that follows a Gaussian (normal) distribution. A Gaussian distribution is characterized by its bell-shaped curve, which is symmetrical around the mean and describes the probability distribution of a continuous random variable. Gaussian fitting involves estimating the parameters of a Gaussian function, such as the mean, standard deviation, and amplitude, that best describe the observed data.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"FQmRHEURTh"}],"key":"CW416Bf0Ep"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Gaussian fitting is important in many aspects of astronomy, as we expect many distributions to be well-described by Gaussians. A\nGaussian can be expressed as:\n","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"v0HHu7mZUL"}],"key":"lMcqmjXyjr"},{"type":"math","value":" f(x) = A \\cdot e^{-\\frac{(x - \\mu)^2}{2\\sigma^2}} ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ef\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi\u003eA\u003c/mi\u003e\u003cmo\u003e⋅\u003c/mo\u003e\u003cmsup\u003e\u003cmi\u003ee\u003c/mi\u003e\u003cmrow\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmfrac\u003e\u003cmrow\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmi\u003eμ\u003c/mi\u003e\u003cmsup\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmn\u003e2\u003c/mn\u003e\u003cmsup\u003e\u003cmi\u003eσ\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003c/mfrac\u003e\u003c/mrow\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e f(x) = A \\cdot e^{-\\frac{(x - \\mu)^2}{2\\sigma^2}} \u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\"\u003ef\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eA\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e⋅\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.3291em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ee\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3291em;\"\u003e\u003cspan style=\"top:-3.4534em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e−\u003c/span\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mopen nulldelimiter sizing reset-size3 size6\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.251em;\"\u003e\u003cspan style=\"top:-2.5062em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size3 size1 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\"\u003eσ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.9384em;\"\u003e\u003cspan style=\"top:-2.9384em;margin-right:0.1em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.2255em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line mtight\" style=\"border-bottom-width:0.049em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.5021em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size3 size1 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mopen mtight\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ex\u003c/span\u003e\u003cspan class=\"mbin mtight\"\u003e−\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\"\u003eμ\u003c/span\u003e\u003cspan class=\"mclose mtight\"\u003e\u003cspan class=\"mclose mtight\"\u003e)\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.0484em;\"\u003e\u003cspan style=\"top:-3.0484em;margin-right:0.1em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.4938em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter sizing reset-size3 size6\"\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"1","key":"EQr0EhYtmt"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Mean (μ)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"THdt6yaub5"}],"key":"m612boV54J"},{"type":"text","value":": The center or average value of the Gaussian distribution.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"tiLOioj59A"}],"key":"pnkXaV73RQ"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Standard Deviation (σ)","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"xznYlMwofb"}],"key":"WhYBn0ZD5H"},{"type":"text","value":": The measure of the spread or dispersion of the Gaussian distribution.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"HjICNfd5P2"}],"key":"esSwpeXBmw"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Amplitude (A)","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"QN5RfuPLM4"}],"key":"LOkL1FZCmd"},{"type":"text","value":": The peak height or maximum value of the Gaussian curve.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"shkbBl4Ubo"}],"key":"t3Q65knkcW"}],"key":"tMEkYbVPyE"}],"data":{"type":"notebook-content"},"key":"RMnnUKk4sK"},{"type":"block","children":[{"type":"admonition","class":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Exercise 1: Fitting a Gaussian to Synthetic Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XTuzjNx9Wk"}],"key":"TCSQM4z1bN"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Using the ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"jjfzLlJNB8"},{"type":"inlineCode","value":"curve_fit","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"WSCpg8PO70"},{"type":"text","value":" function, fit a Gaussian function to the noisy data provided below and estimate the parameters that best describe the underlying Gaussian distribution.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ALIEQhBV8Q"}],"key":"bQRrVDtk7N"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Copy the starter code below","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"lSW3FZRQeW"}],"key":"Hzu5LVBm6j"},{"type":"text","value":": Begin by copying the starter code to generate synthetic data representing noisy measurements of a Gaussian distribution. The data consists of input values (","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"edZPJY8hdx"},{"type":"inlineCode","value":"x","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Ia0pTWHD1g"},{"type":"text","value":") and corresponding noisy observations (","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"IFvEYmN5jF"},{"type":"inlineCode","value":"y_noise","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"rWoNiaOEd1"},{"type":"text","value":").","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"PY3N4JpIuk"}],"key":"FMsguTLYmC"}],"key":"kS1Ytjblvg"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Define the Gaussian Model Function","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"DDCgnCcfNP"}],"key":"HnKLaYQEBK"},{"type":"text","value":": Define a Gaussian model function representing the mathematical form of a Gaussian distribution. The Gaussian function should take input variables (e.g., ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Rzc14bYY2U"},{"type":"inlineCode","value":"x","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"q3xFVCVJbA"},{"type":"text","value":") and parameters (e.g., mean, standard deviation, amplitude) as arguments and return the predicted values of the Gaussian distribution.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"O1zL1tRHzp"}],"key":"EEhuioV4C9"}],"key":"vcdyQzTvpI"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Perform Curve Fitting","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Fk1JTbxJPg"}],"key":"Y0S1Ml9vNd"},{"type":"text","value":": Use the ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"iyfX2JqqYU"},{"type":"inlineCode","value":"curve_fit","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"b25Kf9dZSp"},{"type":"text","value":" function from the SciPy library to fit the Gaussian model function to the noisy data. Provide the input data (","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"m5hjatUsM8"},{"type":"inlineCode","value":"x","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"VjcE2K2Ce2"},{"type":"text","value":") and noisy observations (","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"dT0g1TxXRf"},{"type":"inlineCode","value":"y_noise","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"SLavgfjnjI"},{"type":"text","value":") as input arguments to ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"IBXU3cnCsn"},{"type":"inlineCode","value":"curve_fit","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"wYaRnHmWVh"},{"type":"text","value":". Optionally, you can provide initial estimates for the parameters to aid the fitting process. Look at the ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"yJuoDOyEji"},{"type":"inlineCode","value":"curve_fit","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"alyUW37VGT"},{"type":"text","value":" documentation to see how to do this!","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"i2biOBo9TO"}],"key":"VUjlkFwdBD"}],"key":"wqoZpH5LgZ"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"strong","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Visualize the Fitted Gaussian","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"nN7f8Q0jlM"}],"key":"QSTv1XruKn"},{"type":"text","value":": Plot the noisy data along with the fitted Gaussian distribution to visualize how well the Gaussian model fits the observed data.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"kNlyRKH1yu"}],"key":"jUF7SL9Vn5"}],"key":"t0zN2BlD5f"}],"key":"pxpwMtOcxI"}],"key":"i26F8lqW4h"}],"data":{"type":"notebook-content"},"key":"bYjVOCNvEX"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\nfrom scipy.optimize import curve_fit\n\n# Generate synthetic data following a Gaussian distribution\nx = np.linspace(-5, 5, 100)\ny_true = np.exp(-0.5 * (x ** 2)) / np.sqrt(2 * np.pi)  # True Gaussian distribution\n\n# Add noise to the data to simulate experimental measurements\nnp.random.seed(0)\ny_noise = y_true + np.random.normal(loc=0, scale=0.1, size=len(x))","key":"bkyu33Awgd"},{"type":"output","id":"5KqKxQ3aETwC1LCyhNt1b","data":[],"key":"TmYKAjWqyD"}],"data":{"type":"notebook-code"},"key":"X7Ae6bp0zn"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(figsize=(7,7))\nax.scatter(x, y_noise, color='blue', label='Noisy Data')\nax.plot(x, y_true, linestyle='--', color='green', label='True Gaussian Distribution')\nax.set_xlabel('x', fontsize=14)\nax.set_ylabel('y', fontsize=14)\nax.tick_params(which='both', top=True, right=True, direction='in', length=6)\nax.legend();","key":"CBphPqKCRL"},{"type":"output","id":"i6O2-Zy1dSTbOgW3LW7vN","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0ce15aaf9cea92070116704b3997f417","path":"/build/0ce15aaf9cea92070116704b3997f417.png"},"text/plain":{"content":"\u003cFigure size 700x700 with 1 Axes\u003e","content_type":"text/plain"}}}],"key":"Fo0W1fAGSb"}],"data":{"type":"notebook-code"},"key":"ya0UcDHcau"},{"type":"block","children":[{"type":"admonition","class":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Exercise 2: Fitting a Gaussian to a Real Galaxy Spectrum!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hlGyygCCxI"}],"key":"G5cAcuJunG"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"On slack, we will send a data file with a galaxy spectrum that has the columns ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"MiiVz5El7I"},{"type":"inlineCode","value":"wave","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"rqCEjffH3t"},{"type":"text","value":", ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"VteiB9ijcY"},{"type":"inlineCode","value":"flux","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"QzzdkkUunq"},{"type":"text","value":", and ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"zTgrobvYnV"},{"type":"inlineCode","value":"ivar","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ezZLdyMQDO"},{"type":"text","value":". These stand for the wavelength array (which you would plot on the x-axis), the flux or intensity of emission at every given wavelength (which you would plot on the y-axis), and the inverse variance for each flux measurement.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"srN8dI1PZa"}],"key":"uimfpvI2Kh"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Load in this data, and slice the arrays to select for the H-alpha emission line (this is the largest emission line in this spectrum). Then, using your Gaussian fitting code to fit a Gaussian to the H-alpha line and report the line center and line width.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"vo1rYbcyDv"}],"key":"BcC7xyXWG7"}],"key":"JVX5YRa7u1"}],"data":{"type":"notebook-content"},"key":"e5DNR7gUki"}],"key":"xpF1rF03Qp"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Fitting Models to Data: Bootstrapping","url":"/bootstrapping-lab","group":"Week  8"}}},"domain":"http://localhost:3002"}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":false,"v2_headers":true,"v2_meta":false,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/build/manifest-FDC5A112.js";
import * as route0 from "/build/root-2CYAF5SQ.js";
import * as route1 from "/build/routes/$-ZDWRJY4B.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/build/entry.client-K6EYMIDZ.js");</script></body></html>