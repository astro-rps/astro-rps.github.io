{"kind":"Notebook","sha256":"5641b3efc94de68e007e26a26eeea750c562ba7b5d389257a250504cbc309da5","slug":"gaussian-lab","location":"/02_Labs/Week 8/gaussian_lab.ipynb","dependencies":[],"frontmatter":{"title":"Moving beyond polynomials: Fitting arbitrary functions","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"github":"https://astro-rps.github.io/","keywords":[],"numbering":{"title":{"offset":2}},"edit_url":"https://astro-rps.github.io//blob/main/02_Labs/Week 8/gaussian_lab.ipynb","exports":[{"format":"ipynb","filename":"gaussian_lab.ipynb","url":"/build/gaussian_lab-51d793960f016a9beb2b2eb6407666a0.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In some cases, the relationship between variables in our data may not be well described by a simple polynomial function. When this happens, we need to use more flexible methods that allow us to fit arbitrary functions to our data. One such method is the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QrjU6cDVtr"},{"type":"inlineCode","value":"curve_fit","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"W3enzvh9mM"},{"type":"text","value":" function from the SciPy library, which enables us to fit user-defined functions to our data using non-linear least squares optimization.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"akVdGXTL0W"}],"key":"OftFMfEWhA"},{"type":"heading","depth":2,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Using ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"IqJIPqHP9x"},{"type":"inlineCode","value":"curve_fit","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"NezKy3sTeF"},{"type":"text","value":" in SciPy:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"pI5H5f02Y5"}],"identifier":"using-curve-fit-in-scipy","label":"Using curve_fit in SciPy:","html_id":"using-curve-fit-in-scipy","implicit":true,"key":"wvCcrDmugS"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"fzdVUhLMgF"},{"type":"inlineCode","value":"curve_fit","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"sYxpHy0JZ0"},{"type":"text","value":" function in SciPy is a powerful tool for fitting arbitrary functions to data using non-linear least squares optimization. It takes as input a user-defined model function, along with the observed data and optional initial parameter estimates, and returns the optimal parameter values that minimize the sum of squared residuals between the model predictions and the observed data.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"LLJRuRBxI2"}],"key":"HQ1AGVHlN6"},{"type":"heading","depth":3,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Example: Fitting a Line to the M-sigma Relation using ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"yJk6WEfdT4"},{"type":"inlineCode","value":"curve_fit","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"PFX0FJZ1Lm"}],"identifier":"example-fitting-a-line-to-the-m-sigma-relation-using-curve-fit","label":"Example: Fitting a Line to the M-sigma Relation using curve_fit","html_id":"example-fitting-a-line-to-the-m-sigma-relation-using-curve-fit","implicit":true,"key":"VJrGe3DhQX"}],"key":"kGDFFq79kd"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# First, copy our code from last time to read in the m-sigma data and fit a line with polyfit\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n\ndf = pd.read_csv('m-sigma.txt')\nlog_BH = np.log10(df.M_bh)\nBH_err = df.M_bh_err\n\ncoefficients = np.polyfit(df.sigma,log_BH,deg=1,w=1/BH_err)\nx_fit = np.linspace(50,400,100)\ny_fit = np.polyval(coefficients, x_fit)","key":"y1AeFpq5hO"},{"type":"output","id":"GxMcbsEMqPZT4iDOX6NXY","data":[],"key":"IveRqfh9fc"}],"key":"c8PoM6ih0O"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.optimize import  curve_fit\n\n# Define a linear model function (y = mx + b)\ndef linear_model(x, m, b):\n    return m * x + b\n\n# Perform curve fitting to estimate parameters (slope and intercept)\npopt, pcov = curve_fit(linear_model, df.sigma, log_BH)\n\n# Extract estimated parameters\nslope, intercept = popt","key":"YDzjSOA16H"},{"type":"output","id":"xUBxfiwfUCEkXwlz9xNcA","data":[],"key":"wZnGCwD2LT"}],"key":"oUtqshB5Fx"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We usually call the outputs of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NgkunMHhQQ"},{"type":"inlineCode","value":"curve_fit","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ob7ZO2RAkE"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hELOfYBOl5"},{"type":"inlineCode","value":"popt","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EToIX92Ptx"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ynopLDyVWW"},{"type":"inlineCode","value":"pcov","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SCaKamk8kL"},{"type":"text","value":". These represent:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xOeKJDBlqK"}],"key":"fbwgeZ7e1U"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"inlineCode","value":"popt","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"z6gX4DTg8z"},{"type":"text","value":": This variable holds the best estimates of the parameters (e.g., slope and intercept) for the fitted model. It’s what we use to get the actual values of the parameters we’re interested in. The ordering of ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"zUFO9AseW7"},{"type":"inlineCode","value":"popt","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"UQGjobRWtG"},{"type":"text","value":" matches the ordering of the paramters in our ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"F0EkjeJQSA"},{"type":"inlineCode","value":"linear_model","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"e6yk5O6hJa"},{"type":"text","value":" user defined function after the first arguement (which is the data x).","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"XvUULsTZeA"}],"key":"i3frIRXqOT"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"inlineCode","value":"pcov","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XGmihuOo6T"},{"type":"text","value":": This variable represents the covariance matrix, which tells us about the uncertainty or correlation between the estimated parameters. It helps us understand how reliable our parameter estimates are. Specifically, it provides information about how much the estimated parameters vary together. If two parameters are highly correlated, changes in one may influence the estimate of the other. For now, we can ignore this.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PJfEEoweOp"}],"key":"lm2EDkFZv8"}],"key":"LXDArZ7t9E"}],"key":"U6wjozdxT6"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(figsize=(7,7))\nax.errorbar(df.sigma, log_BH, yerr=BH_err, xerr=df.sigma_err, fmt='None', color='gray')\nax.plot(df.sigma, log_BH, 's', color='blue', ms=12, alpha=0.5, mec='k')\n\nax.plot(x_fit, y_fit, 'k', lw=3, label = 'Polyfit Line')\nax.plot(df.sigma, linear_model(df.sigma, slope, intercept), color='red', label='Curve Fit Line')\n\nax.set_xlabel('Velocity Dispersion [km/s]', fontsize=16)\nax.tick_params(which='both', top=True, right=True, direction='in', length=6)\nax.set_ylabel(r'log M$_{\\rm BH}$ [$M_{\\odot}$]', fontsize=16)\nax.legend();","key":"M5XKN3Oaej"},{"type":"output","id":"WnBm15RZnJn9yzPOBsos-","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"46f570c564be7aa375dbfc93afe19fc1","path":"/build/46f570c564be7aa375dbfc93afe19fc1.png"},"text/plain":{"content":"<Figure size 700x700 with 1 Axes>","content_type":"text/plain"}}}],"key":"rND1SipJQi"}],"key":"egb1n1Pkbe"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Note: these fits may be slightly different because we are not incorporating errors in the fit using ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Mmk6yTcLgf"},{"type":"inlineCode","value":"curve_fit","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JEyhrrM4im"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LtUoEVa8Fy"}],"key":"gcLK5GoxKJ"}],"key":"nZXz4dhJKF"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"A Common Use-Case: Gaussian Fitting","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RQDEZfJsYL"}],"identifier":"a-common-use-case-gaussian-fitting","label":"A Common Use-Case: Gaussian Fitting","html_id":"a-common-use-case-gaussian-fitting","implicit":true,"key":"PSM04vXQ82"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Gaussian fitting, also known as Gaussian curve fitting or Gaussian distribution fitting, is a statistical method used to model data that follows a Gaussian (normal) distribution. A Gaussian distribution is characterized by its bell-shaped curve, which is symmetrical around the mean and describes the probability distribution of a continuous random variable. Gaussian fitting involves estimating the parameters of a Gaussian function, such as the mean, standard deviation, and amplitude, that best describe the observed data.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"oZmjHKu62y"}],"key":"WqN1cMg4yZ"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Gaussian fitting is important in many aspects of astronomy, as we expect many distributions to be well-described by Gaussians. A\nGaussian can be expressed as:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"QdPh8FdcVk"}],"key":"oEE4n0aF69"},{"type":"math","value":"f(x) = A \\cdot e^{-\\frac{(x - \\mu)^2}{2\\sigma^2}}","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"tight":"before","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>A</mi><mo>⋅</mo><msup><mi>e</mi><mrow><mo>−</mo><mfrac><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>−</mo><mi>μ</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow><mrow><mn>2</mn><msup><mi>σ</mi><mn>2</mn></msup></mrow></mfrac></mrow></msup></mrow><annotation encoding=\"application/x-tex\">f(x) = A \\cdot e^{-\\frac{(x - \\mu)^2}{2\\sigma^2}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.3291em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3291em;\"><span style=\"top:-3.4534em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\"><span class=\"mopen nulldelimiter sizing reset-size3 size6\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.251em;\"><span style=\"top:-2.5062em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9384em;\"><span style=\"top:-2.9384em;margin-right:0.1em;\"><span class=\"pstrut\" style=\"height:2.6444em;\"></span><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.2255em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line mtight\" style=\"border-bottom-width:0.049em;\"></span></span><span style=\"top:-3.5021em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">x</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\">μ</span><span class=\"mclose mtight\"><span class=\"mclose mtight\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0484em;\"><span style=\"top:-3.0484em;margin-right:0.1em;\"><span class=\"pstrut\" style=\"height:2.6444em;\"></span><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4938em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter sizing reset-size3 size6\"></span></span></span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"1","key":"Wd5Dp93BHF"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Mean (μ)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Pbv3hx8Vgs"}],"key":"muBEmJeA4f"},{"type":"text","value":": The center or average value of the Gaussian distribution.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"PgwvaDrKML"}],"key":"Up0MTNrukA"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Standard Deviation (σ)","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"N21PAwrPox"}],"key":"Tc3Zv8eVbS"},{"type":"text","value":": The measure of the spread or dispersion of the Gaussian distribution.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"srtQx8iC9A"}],"key":"m1MJP1pLTc"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Amplitude (A)","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"qmh7GWb7Zq"}],"key":"iDp5pNqfLZ"},{"type":"text","value":": The peak height or maximum value of the Gaussian curve.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"imrHdDO5GT"}],"key":"N3hIvEExpW"}],"key":"oLASE29qFI"}],"key":"whB3OTQ7Vy"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Exercise 1: Fitting a Gaussian to Synthetic Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MbVEtwImSm"}],"key":"nVVQCUoRFc"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Using the ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"DUObZ6BNuX"},{"type":"inlineCode","value":"curve_fit","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"sWZw0NIKi7"},{"type":"text","value":" function, fit a Gaussian function to the noisy data provided below and estimate the parameters that best describe the underlying Gaussian distribution.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"zxhoWD9iQS"}],"key":"mkSjMhrCQV"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Copy the starter code below","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"MpfyfPO0c9"}],"key":"QDJC8aDql8"},{"type":"text","value":": Begin by copying the starter code to generate synthetic data representing noisy measurements of a Gaussian distribution. The data consists of input values (","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Msm9brQ8wK"},{"type":"inlineCode","value":"x","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"hE8Ws9HOGh"},{"type":"text","value":") and corresponding noisy observations (","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"XfcM7pOd7t"},{"type":"inlineCode","value":"y_noise","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"yOdKX9q0gn"},{"type":"text","value":").","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"pvy9UQ407L"}],"key":"igY6XyBdMy"}],"key":"a4jxJMZyLw"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Define the Gaussian Model Function","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"hJUMxhaWTX"}],"key":"nzCrdygpWN"},{"type":"text","value":": Define a Gaussian model function representing the mathematical form of a Gaussian distribution. The Gaussian function should take input variables (e.g., ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"X5SiS5srdV"},{"type":"inlineCode","value":"x","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"N87585NGMe"},{"type":"text","value":") and parameters (e.g., mean, standard deviation, amplitude) as arguments and return the predicted values of the Gaussian distribution.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"cT6CelpNQb"}],"key":"fmoUYJY8jR"}],"key":"hH7miKQhGb"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Perform Curve Fitting","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"gkot7E18gW"}],"key":"r5Xjo0VFHB"},{"type":"text","value":": Use the ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"MeSpVi8RFV"},{"type":"inlineCode","value":"curve_fit","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"fE3dEpFJau"},{"type":"text","value":" function from the SciPy library to fit the Gaussian model function to the noisy data. Provide the input data (","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"f5kzAdLWVB"},{"type":"inlineCode","value":"x","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"vcoWLv5hhT"},{"type":"text","value":") and noisy observations (","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"GUmPPiyYy4"},{"type":"inlineCode","value":"y_noise","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"fkiQoSPMhT"},{"type":"text","value":") as input arguments to ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"D5ZH3dBuBX"},{"type":"inlineCode","value":"curve_fit","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"ru5imWUvhq"},{"type":"text","value":". Optionally, you can provide initial estimates for the parameters to aid the fitting process. Look at the ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"q46uUAfh5g"},{"type":"inlineCode","value":"curve_fit","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"TiDmGoT7QI"},{"type":"text","value":" documentation to see how to do this!","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"gLG7yFNSLH"}],"key":"Jd9C9ESEk4"}],"key":"fChbOB3Awv"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"strong","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Visualize the Fitted Gaussian","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"BRCKHVEqSk"}],"key":"hcgzGpJwni"},{"type":"text","value":": Plot the noisy data along with the fitted Gaussian distribution to visualize how well the Gaussian model fits the observed data.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"eCenPqF8NQ"}],"key":"RZpFbvC8TI"}],"key":"huGELOIIC0"}],"key":"r7J0utKHgc"}],"class":"tip","key":"atTE6QADlQ"}],"key":"R23Y6qKaXl"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\nfrom scipy.optimize import curve_fit\n\n# Generate synthetic data following a Gaussian distribution\nx = np.linspace(-5, 5, 100)\ny_true = np.exp(-0.5 * (x ** 2)) / np.sqrt(2 * np.pi)  # True Gaussian distribution\n\n# Add noise to the data to simulate experimental measurements\nnp.random.seed(0)\ny_noise = y_true + np.random.normal(loc=0, scale=0.1, size=len(x))","key":"hppIQqdE22"},{"type":"output","id":"kFHBigunChvYxXBcVHl90","data":[],"key":"CAVQ9dr0yf"}],"key":"GtmgezwADy"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(figsize=(7,7))\nax.scatter(x, y_noise, color='blue', label='Noisy Data')\nax.plot(x, y_true, linestyle='--', color='green', label='True Gaussian Distribution')\nax.set_xlabel('x', fontsize=14)\nax.set_ylabel('y', fontsize=14)\nax.tick_params(which='both', top=True, right=True, direction='in', length=6)\nax.legend();","key":"OK9pBRCdmp"},{"type":"output","id":"vrJqobHpz9QxQnWHy_2ql","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0ce15aaf9cea92070116704b3997f417","path":"/build/0ce15aaf9cea92070116704b3997f417.png"},"text/plain":{"content":"<Figure size 700x700 with 1 Axes>","content_type":"text/plain"}}}],"key":"sIHakC8wa9"}],"key":"i64MAOq9IN"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Exercise 2: Fitting a Gaussian to a Real Galaxy Spectrum!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mEZBfeTNWh"}],"key":"PF6CDJ8Dha"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"On slack, we will send a data file with a galaxy spectrum that has the columns ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"U66wIS0xCp"},{"type":"inlineCode","value":"wave","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"OhXRDmx27I"},{"type":"text","value":", ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"uiFxUbKmGp"},{"type":"inlineCode","value":"flux","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"V92NmpGPKa"},{"type":"text","value":", and ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Zv3pENESOX"},{"type":"inlineCode","value":"ivar","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"PLiEQVW8YY"},{"type":"text","value":". These stand for the wavelength array (which you would plot on the x-axis), the flux or intensity of emission at every given wavelength (which you would plot on the y-axis), and the inverse variance for each flux measurement.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"HxYrbx7jY9"}],"key":"xA2uNZgztC"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Load in this data, and slice the arrays to select for the H-alpha emission line (this is the largest emission line in this spectrum). Then, using your Gaussian fitting code to fit a Gaussian to the H-alpha line and report the line center and line width.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"sqHt0ikiPM"}],"key":"R8OuxVpqqs"}],"class":"tip","key":"Kd1UIcxqUV"}],"key":"f2gXILqddT"}],"key":"HOiaoh3fJe"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Fitting Models to Data: Bootstrapping","url":"/bootstrapping-lab","group":"Week  8"}}},"domain":"http://localhost:3000"}