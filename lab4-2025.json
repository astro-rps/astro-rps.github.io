{"kind":"Notebook","sha256":"5360855241815cafefffcb408e49a9cf1d6e48ce9d0ff247271114f2a864a84b","slug":"lab4-2025","location":"/02_Labs/Week 4/Lab4_2025.ipynb","dependencies":[],"frontmatter":{"title":"Lab 4: Exploring Cosmological Parameters with Functions","content_includes_title":false,"kernelspec":{"name":"ugali_kernel","display_name":"ugali_kernel","language":"python"},"github":"https://astro-rps.github.io/","keywords":[],"numbering":{"title":{"offset":2}},"edit_url":"https://astro-rps.github.io//blob/main/02_Labs/Week 4/Lab4_2025.ipynb","exports":[{"format":"ipynb","filename":"Lab4_2025.ipynb","url":"/build/Lab4_2025-76446d6b6238d43d411fd9362f7965bd.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Objective:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"g4RTEPgi5d"}],"identifier":"objective","label":"Objective:","html_id":"objective","implicit":true,"key":"dwgYoNzPkk"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"This Lab will help you develop and practice your ability to write Python functions in the context of cosmology.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"aSKlZSqYHN"}],"key":"AaspLuApXv"},{"type":"heading","depth":3,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Background: Hubble’s Law","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"V5V96l3Vdv"}],"identifier":"background-hubbles-law","label":"Background: Hubble’s Law","html_id":"background-hubbles-law","implicit":true,"key":"yH0HnLSJF0"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Hubble’s Law describes the relationship between the velocity of a galaxy and its distance from us:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"PF4J7BelAe"}],"key":"qnxl2e5ONx"},{"type":"math","value":"v = H_0 \\times d","position":{"start":{"line":9,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>v</mi><mo>=</mo><msub><mi>H</mi><mn>0</mn></msub><mo>×</mo><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">v = H_0 \\times d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span></span></span></span></span>","enumerator":"1","key":"Uob3FIkeNm"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"dAZZPed78u"},{"type":"inlineMath","value":"v","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>","key":"HIuZGlUyiz"},{"type":"text","value":" is is the recession velocity of a galaxy (in km/s), ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"VtO44begI7"},{"type":"inlineMath","value":"H_0","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">H_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"jTNhY87L5D"},{"type":"text","value":" is the Hubble constant (in km/s/Mpc, assume 70 km/s/Mpc), and ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"yhLm6Ci8nk"},{"type":"inlineMath","value":"d","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span></span></span></span>","key":"FdvWTBG9zf"},{"type":"text","value":" is the distance of the galaxy (in Mpc).  ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"BhklFdxImb"},{"type":"inlineMath","value":"H_0","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">H_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"hXhnrf3488"},{"type":"text","value":" is the present-day expansion rate of the universe. In general, we cannot measure direct distances to very distant galaxies, and so we measure the recessional velocity ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"ZDh6mO9vgS"},{"type":"inlineMath","value":"v","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>","key":"G8EMThoLEn"},{"type":"text","value":" and can use that to find ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"V9LYibWcha"},{"type":"inlineMath","value":"d","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span></span></span></span>","key":"v1rISkXKGe"},{"type":"text","value":". The fact that this correlation exists is a consequence of the fact that ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"b1vNH3F6pG"},{"type":"emphasis","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"our universe is expanding","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"k1xl4VZAMN"}],"key":"yWchyohSSp"},{"type":"text","value":".","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"qa83cQ4m2n"}],"key":"DnFvcmjl2U"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Exercise 1: Cosmic Distances with Hubble’s Law","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"pKZSLxRaej"}],"key":"EwcdqYSneR"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":17,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Define a function ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"DavwJsKXfY"},{"type":"inlineCode","value":"hubble_distance","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"BmnF3Rg0cj"},{"type":"text","value":" to calculate the distance to a galaxy based on this formula. The function should take one required argument, the recessional velocity in km/s, and should return the distance to the galaxy in Megaparsecs (Mpc).","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"aG34T2UobB"}],"key":"UsIOXfrRb9"}],"key":"YRYaqIrmoI"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Add the Hubble constant as an optional argument that takes a default value of 70 km/s/Mpc.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"sPZej40ns3"}],"key":"JHalOqAHFQ"}],"key":"jsEYnKfjv4"},{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Add a print statement of the form “Given a recessional velocity of [] and a Hubble constant on [], a galaxy’s distance would be []” (fill in the units here, and use f-strings to handle the values).","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"mb0V7IYUQr"}],"key":"rcpuNZSn63"}],"key":"jezZi9zWNJ"},{"type":"listItem","spread":true,"position":{"start":{"line":24,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":24,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Verify your code by checking that you recover 20 Mpc as the distance for a galaxy moving at 1400 km/s, assuming the default ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"zb4Iluughp"},{"type":"inlineMath","value":"H_0","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">H_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"iaVW1twN63"},{"type":"text","value":" value.\n(for reference, 20 Mpc is in the local universe, and space telescopes like JWST can resolve individual stars in galaxies at this distance).","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"N1SFleKfH6"}],"key":"BFLgQcjc1T"}],"key":"mVjWRUTpKn"},{"type":"listItem","spread":true,"position":{"start":{"line":27,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"Now, create an evenly-spaced array (hint: np.arange or np.linspace is your friend here!) of 20 recessional velocities called ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"e6AD8WX3jx"},{"type":"strong","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"recess_vels","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"OL4vp0O9qd"}],"key":"smbmAuOoVI"},{"type":"text","value":" in the range [1000,100000]. Using a loop, evaluate your function over each element. Store the results in a list","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"alFSrBTt0D"}],"key":"afVyQjZvYY"}],"key":"ICbRIyO803"},{"type":"listItem","spread":true,"position":{"start":{"line":30,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"Without","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"I3uLCSOFrz"}],"key":"zoh0sziArE"},{"type":"text","value":" using a loop, evaluate your function over ","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"uzAxE7z5oF"},{"type":"strong","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"recess_vels","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"ap2lWGgD1J"}],"key":"J0ZkbVff3O"},{"type":"text","value":".","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"DjU2MqBHwZ"}],"key":"hwCtxzoN0Z"}],"key":"STZPD7fGvA"},{"type":"listItem","spread":true,"position":{"start":{"line":33,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"The output from 6 just prints everything in a rather sloppy way. Go back and add another optional argument ","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"uCnhks0mtz"},{"type":"strong","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"print_res","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"iDuUYuEXGk"}],"key":"UScgRQGtaO"},{"type":"text","value":" that is a boolean defaulting to False. Using an if statement, make it so that the results statement only prints if this variable is set to True.","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"QvP9k7tqZE"}],"key":"qeG1Q2Xzog"}],"key":"GJuT7AoVds"},{"type":"listItem","spread":true,"position":{"start":{"line":36,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"Add type decorators to the inputs. See the Week 4 notes for a reminder if needed!","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"TphkQO6Vhl"}],"key":"DI8FinPXNv"}],"key":"IrKacyKLuN"},{"type":"listItem","spread":true,"position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"Lastly, add a docstring detailing the purpose of the function, its arguments, and the return type.","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"UYdP45QZ07"}],"key":"tHkrt4BqhN"}],"key":"nD1B6p1E5c"}],"key":"fALmRXGfcj"}],"key":"P2HNJqy4bn"}],"key":"ip4T2JtOan"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Questions 5-6 above get at a core concept in Python: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wvm6mLrMoK"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"vectorization","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qSpyXAy4Jw"}],"key":"XfIAlriIt2"},{"type":"text","value":". In Python, it will essentially always be faster to carry out an operation over a vector (array) simultaneously (part 5) as opposed to using a loop (part 4). This might not matter for small datasets but will become increasingly relevant as your dataset grows.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nj50ZjBYn0"}],"key":"lobuKFMrfq"}],"key":"N6rCcPKjgl"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now, we can make it even more sophisticated! We will now build subsequent functions that expand upon the one above. This incremental function-building is a core component of research, since you rarely write a single function that does everything you want.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AsN5Jd267n"}],"key":"L3JBv1obv1"}],"key":"X3qKpcTsfp"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Background: The Cosmic Critical Density","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Lis5uRdEK0"}],"identifier":"background-the-cosmic-critical-density","label":"Background: The Cosmic Critical Density","html_id":"background-the-cosmic-critical-density","implicit":true,"key":"dcAdvMr06B"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The cosmic ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"WAtxDjfu3e"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"critical density","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fuzyhMwhGe"}],"key":"xQssgryvrj"},{"type":"text","value":" is the average density of matter and energy needed for the universe to be flat. If the actual density is higher, the universe is “closed” may eventually collapse; if the density is lower, the universe is “open” and will expand forever.  It can be calculated from the Hubble Constant via","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"WE3A09qY7z"}],"key":"WyhNVppTvK"},{"type":"math","value":"\\rho_c = \\frac{3H_0^2}{8\\pi G}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"tight":"before","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>ρ</mi><mi>c</mi></msub><mo>=</mo><mfrac><mrow><mn>3</mn><msubsup><mi>H</mi><mn>0</mn><mn>2</mn></msubsup></mrow><mrow><mn>8</mn><mi>π</mi><mi>G</mi></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\rho_c = \\frac{3H_0^2}{8\\pi G}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.1771em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4911em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">8</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mord mathnormal\">G</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">3</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-2.4519em;margin-left:-0.0813em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2481em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"2","key":"ybrwA6p47C"},{"type":"heading","depth":3,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Background: The Age of the Universe","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"RnCplPBt6A"}],"identifier":"background-the-age-of-the-universe","label":"Background: The Age of the Universe","html_id":"background-the-age-of-the-universe","implicit":true,"key":"GicHBW3EXM"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Because the universe has been continuously expanding since the origin of the universe, the present-day expansion rate can be used to approximate the age of the universe. Put explicitly, the age of the universe can be estimated roughly as","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"T8ydvVymSX"}],"key":"vIwilgeYKo"},{"type":"math","value":"t = \\frac{1}{H_0}","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"tight":true,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>t</mi><mo>=</mo><mfrac><mn>1</mn><msub><mi>H</mi><mn>0</mn></msub></mfrac></mrow><annotation encoding=\"application/x-tex\">t = \\frac{1}{H_0}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.1574em;vertical-align:-0.836em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"3","key":"XYaewnb2bJ"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"(but you need to be careful about units: you need to first convert ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"FW165rM6eG"},{"type":"inlineMath","value":"H_0","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">H_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"vTudo4cxLj"},{"type":"text","value":" to units of inverse seconds for this to work.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Irk02JEqFt"}],"key":"pYaCQK1Zag"}],"key":"sUdmyCZItk"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Exercise 2: Nested Functions","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"spmkA8bqXt"}],"key":"vlwIxWaoQR"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"In this exercise you will take data about galaxy distances and recession velocities and use it to derive the density, age, and shape of the universe.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ecU7AtOwY5"}],"key":"rLprqu4AbQ"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Write a function ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"kEeAhfMxNe"},{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"get_hubble_constant","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"DYljO2R2ZH"}],"key":"O0cD8UsIqs"},{"type":"text","value":" which takes in an array of galaxy distances in Mpc and an array of recessional velocities in km/s. Compute ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Jw8iHYCJp2"},{"type":"inlineMath","value":"H_0","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">H_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"B6ue2yrfgP"},{"type":"text","value":" for each element and then return a single average. Don’t use loops for anything in this exercise!","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"SvGIz6i0pp"}],"key":"vKELfPsg4I"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Write a function ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"M4v3zqsV95"},{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"get_critical_density","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"raT48EChLW"}],"key":"LM0P31Fy5m"},{"type":"text","value":" that computes the critical density according to the above formula, with only a single argument of ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"oMJZvpEkgS"},{"type":"inlineMath","value":"H_0","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">H_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"M6L8dI7WAK"},{"type":"text","value":". Determine and print the “shape” of the universe (open, closed, flat) by comparing against a model where the Hubble constant is fixed to ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"WyOzATu98m"},{"type":"inlineMath","value":"H_0 = 73","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>=</mo><mn>73</mn></mrow><annotation encoding=\"application/x-tex\">H_0 = 73</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">73</span></span></span></span>","key":"JOTIQTdcZj"},{"type":"text","value":" (which is realistic, and we think we live in a flat universe).","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"xY15x1eM0s"}],"key":"TvV1rfOANF"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Write a function ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"wsfOAkgXgb"},{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"get_universe_age","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"bz1xfZo5rH"}],"key":"wdA0bqAgJb"},{"type":"text","value":" that takes in ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"giwnHxZQcG"},{"type":"inlineMath","value":"H_0","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">H_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"gDbgyzgpzg"},{"type":"text","value":" in km/s/Mpc and returns the age of the universe in years. Note that you need to include two unit conversions: first, you will need to convert km/s/Mpc to just 1/s. After inverting this, you can then convert the time in seconds to a time in years.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"GszFt6EP5b"}],"key":"w2s4AgcSdh"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Write a function ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"AJqCM6kC8j"},{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"cosmology_solver","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"FCkMSn4b8x"}],"key":"RcGBb4Fe2H"},{"type":"text","value":" that wraps all of the three functions, i.e., it calculates the critical density, shape, and age of the universe. Specifically, it should take the same inputs as ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"wRlt3P2by3"},{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"get_hubble_constant","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"ixIlWBJgod"}],"key":"uSQGHD61AA"},{"type":"text","value":". Within ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"i4ndNglAMF"},{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"cosmology_solver","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"QsOhJpkcdh"}],"key":"w3EnYbkGz2"},{"type":"text","value":", you should run each of the functions you created above such that you can figure out the properties of the univese for a given dataset of galaxy distances/recession velocities. Print the critical density.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Z98epJUQzc"}],"key":"IaYGna6hOF"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Test your complete cosmology solver with the following data: distances: [45,100,200,400] Mpc and velocities [3400, 7600, 15200, 31800] km/s. What kind of univese do you end up with? Is it older or younger than our ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"bt0zkVRcZt"},{"type":"inlineMath","value":"H_0 = 70","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>=</mo><mn>70</mn></mrow><annotation encoding=\"application/x-tex\">H_0 = 70</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">70</span></span></span></span>","key":"bgDTMTuc0b"},{"type":"text","value":"ish universe?","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"vqNDagJjOP"}],"key":"SvrCJuSvV6"}],"key":"GrkKsBNzE8"}],"key":"EVJHPDodzS"}],"key":"qGn5TLIYCb"}],"key":"eGO2dugxuZ"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Week 3 Lab: Program Flow, Logic, and Loops with the Messier Catalog!","url":"/lab3-2025","group":"Week  3"}}},"domain":"http://localhost:3004"}