<!DOCTYPE html><html lang="en" class="light" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Astro RPS</title><link rel="stylesheet" href="/build/_assets/app-LVHQOBTF.css"/><link rel="stylesheet" href="/build/_assets/thebe-core-SJEQ5G4L.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 fixed w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-wrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center"><div class="block xl:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 013.75 6h16.5a.75.75 0 010 1.5H3.75A.75.75 0 013 6.75zM3 12a.75.75 0 01.75-.75h16.5a.75.75 0 010 1.5H3.75A.75.75 0 013 12zm0 5.25a.75.75 0 01.75-.75h16.5a.75.75 0 010 1.5H3.75a.75.75 0 01-.75-.75z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/"><div class="p-1 mr-3 dark:bg-white dark:rounded"><img src="/build/astro-rps-logo-5e1744e2e1dba761340324e371f9a0e6.webp" class="h-9" alt="Astro RPS" height="2.25rem"/></div><span class="text-md sm:text-xl tracking-tight sm:mr-5 sr-only">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button class="theme rounded-full border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Change theme to dark mode." aria-label="Change theme to dark mode."><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="h-full w-full p-0.5"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><div class="fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><nav aria-label="Table of Contents" class="flex-grow overflow-y-auto transition-opacity mt-6 pb-3 ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white"><a title="Astro RPS" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/">Astro RPS</a><a title="Course Topics" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/topiclist">Course Topics</a><div data-state="open" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Lectures" class="block break-words rounded py-2 grow font-semibold text-blue-800 dark:text-blue-200 cursor-pointer">Lectures</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" type="button" aria-controls="radix-:R3d8p:" aria-expanded="true" data-state="open"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="open" id="radix-:R3d8p:" class="pl-3 pr-[2px] collapsible-content"><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Week  1" class="block break-words rounded py-2 grow cursor-pointer">Week  1</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" type="button" aria-controls="radix-:R3bd8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R3bd8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Week  2" class="block break-words rounded py-2 grow cursor-pointer">Week  2</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" type="button" aria-controls="radix-:R5bd8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R5bd8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Week  3" class="block break-words rounded py-2 grow cursor-pointer">Week  3</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" type="button" aria-controls="radix-:R7bd8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R7bd8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Week  4" class="block break-words rounded py-2 grow cursor-pointer">Week  4</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" type="button" aria-controls="radix-:R9bd8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R9bd8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Week  5" class="block break-words rounded py-2 grow cursor-pointer">Week  5</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" type="button" aria-controls="radix-:Rbbd8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rbbd8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="open" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Week  8" class="block break-words rounded py-2 grow font-semibold text-blue-800 dark:text-blue-200 cursor-pointer">Week  8</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" type="button" aria-controls="radix-:Rdbd8p:" aria-expanded="true" data-state="open"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="open" id="radix-:Rdbd8p:" class="pl-3 pr-[2px] collapsible-content"><a title="Introduction to Inference in Astronomy: Fitting Models to Data" aria-current="page" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg bg-blue-300/30 active" href="/week8-linear-regression">Introduction to Inference in Astronomy: Fitting Models to Data</a></div></div></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Labs" class="block break-words rounded py-2 grow cursor-pointer">Labs</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" type="button" aria-controls="radix-:R4d8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R4d8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div></div></nav><div class="flex-none py-4 transition-all duration-700 translate-y-6 opacity-0"><a class="flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><article class="article content article-grid grid-gap" style="margin-top:60px"><main class="article-grid subgrid-gap col-screen"><div class="sticky z-10 hidden h-0 col-margin-right-inset lg:block" style="top:60px"><nav></nav></div><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="pt-5 mb-8"><div class="flex items-center h-6 mt-3 mb-5 text-sm font-light"><div class="flex-grow"></div><a href="https://github.com/https://astro-rps.github.io/" title="GitHub Repository: https://astro-rps.github.io/" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><div class="inline-block mr-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block"><path d="M20.2 1.7c0 .8-.5 1.4-1.3 1.5-.8 0-1.4-.5-1.5-1.3 0-.8.5-1.4 1.3-1.5.8-.1 1.5.5 1.5 1.3zM12 17.9c-3.7 0-7-1.3-8.7-3.3 1.8 4.8 7.1 7.3 11.9 5.5 2.5-.9 4.5-2.9 5.5-5.5-1.7 2-4.9 3.3-8.7 3.3zM12 5.1c3.7 0 7 1.3 8.7 3.3-1.8-4.8-7.1-7.3-11.9-5.5-2.5.9-4.5 2.9-5.5 5.5 1.7-2 5-3.3 8.7-3.3zM6.9 21.8c.1 1-.7 1.8-1.7 1.9-1 .1-1.8-.7-1.9-1.7 0-1 .7-1.8 1.7-1.9 1-.1 1.8.7 1.9 1.7zM3.7 4.6c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1c0 .5-.4 1-1 1z"></path></svg></div><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative" id="headlessui-menu-button-:R1khtop:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="ml-2 -mr-1"><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="mb-0">Introduction to Inference in Astronomy: Fitting Models to Data</h1></div><div id="skip-to-article"></div><div id="thahRKJJeh" class="relative group/block article-grid subgrid-gap col-screen"><p>Today, we’ll explore what data science entails, the importance of model fitting and how we can apply it in astronomical data analysis, and the role of inference in drawing meaningful conclusions from our observations.</p><p>Inference refers to the process of comparing models to data and is a fundamental aspect of data analysis in astronomy. In the context of astronomy, model fitting enables us to extract valuable information about the physical properties of objects (like stars, galaxies, exoplanets, etc) by comparing observational data to theoretical models or mathematical functions.</p><p>This notebook will cover two of the most fundamental models with use in astronomy: lines and gaussian curves.</p></div><div id="i0PjWzQasN" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="linear-regression" class="relative group"><span class="heading-text">Linear Regression:</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#linear-regression" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Linear regression just means “let’s fit a line”! It’s a statistical method used to model the relationship between a dependent variable (often denoted as ‘y’) and one or more independent variables (often denoted as ‘x’). It assumes that the relationship between the variables can be described by a linear equation, such as a straight line in the case of simple linear regression. Like an inference task, the goal of linear regression is to find the best-fitting line that minimizes the differences between the observed values and the values predicted by the model.</p><p>For the simpliest case of a straight line, aka a first order polynomial, we can describe our model using two parameters: <strong>slope</strong> and <strong>intercept</strong>.</p></div><div id="WhyX3WNWIJ" class="relative group/block article-grid subgrid-gap col-screen"><h3 id="how-can-we-implement-this-in-python" class="relative group"><span class="heading-text">How can we implement this in python?</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#how-can-we-implement-this-in-python" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p><code>np.polyfit</code> is a function in NumPy used for polynomial regression, which fits a polynomial curve to a set of data points. In the context of linear regression, <code>np.polyfit</code> fits a polynomial of degree 1 (a straight line) to the given data points by minimizing the sum of squared errors between the observed and predicted values. This function returns the coefficients of the polynomial that best fits the data, allowing us to determine the slope and intercept of the regression line.</p></div><div id="SikNGxvpSN" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">import numpy as np
import matplotlib.pyplot as plt

# Generate fake data for demonstration
x = np.array([1, 2, 3, 4, 5])
y = np.array([2.1, 3.9, 5.8, 8.2, 10.1])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="skzH0qcuMFALwlVG4aYlq" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="L9twhWvNAb" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Fit a straight line (polynomial of degree 1) to the data
coefficients = np.polyfit(x, y, deg=1)
coefficients</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="pjyyeFXYfS_IqopB6AW_s" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>array([ 2.03, -0.07])</span></code></div></div></div><div id="VqcF3EjEl4" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Extract the slope (m) and intercept (b) from the coefficients
slope, intercept = coefficients
# note: you can do this more efficiently by just writing: slope, intercept = np.polyfit(x, y, deg=1),
# but I wanted to print coefficients to show the actual output of polyfit

# Print the equation of the fitted line
print(f&quot;Fitted line equation: y = {slope:.2f}x + {intercept:.2f}&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Dc54uC8AFCaE7AeiEwZnE" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Fitted line equation: y = 2.03x + -0.07
</span></code></pre></div></div></div><div id="lLJNE61vWp" class="relative group/block article-grid subgrid-gap col-screen"><p>So we have managed to fit a line to our data! Horray! Now let’s plot both the data and model:</p></div><div id="oTxqQCmqK1" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Generate points along the fitted line for plotting
x_fit = np.linspace(min(x), max(x), 100)
y_fit = slope * x_fit + intercept

# Plot the data points and the fitted line
plt.figure(figsize=(8, 6))
plt.scatter(x, y, color=&quot;blue&quot;, label=&quot;Data&quot;)
plt.plot(x_fit, y_fit, color=&quot;red&quot;, label=&quot;Fitted Line&quot;)
plt.xlabel(&quot;x&quot;, fontsize=14)
plt.ylabel(&quot;y&quot;, fontsize=14)
plt.legend()
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="3hJHLo0s8ryvJensZxCbo" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/build/df23e494163385452b38e8f50d5e57f1.png" alt="&lt;Figure size 800x600 with 1 Axes&gt;"/></div></div><div id="UcRmp9vinH" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="a-practical-astronomy-application-the-m-sigma-relation" class="relative group"><span class="heading-text">A practical astronomy application: The M-sigma Relation</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#a-practical-astronomy-application-the-m-sigma-relation" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>The M-sigma relation, also known as the black hole mass-velocity dispersion relation, is an empirical correlation observed between the mass of supermassive black holes (<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mrow><mi>b</mi><mi>h</mi></mrow></msub></mrow><annotation encoding="application/x-tex">M_{bh}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">bh</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>) at the centers of galaxies and the velocity dispersion (<!-- -->σ<!-- -->) of stars in the bulges of those galaxies. This relationship suggests that there is a tight connection between the properties of galaxies and the central black holes they host. Specifically, galaxies with larger velocity dispersions tend to harbor more massive black holes at their centers.</p><p>The M-sigma relation has profound implications for our understanding of galaxy formation and evolution, as well as the co-evolution of galaxies and their central black holes. It provides valuable insights into the mechanisms governing the growth and regulation of supermassive black holes, the role of feedback processes in galaxy evolution, and the relationship between the properties of galactic bulges and their central black holes.</p></div><div id="EP65R6nE4E" class="relative group/block article-grid subgrid-gap col-screen"><aside class="my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden rounded border-l-4 border-green-600"><div class="m-0 font-medium py-1 flex min-w-0 text-lg text-green-600 bg-green-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="2rem" height="2rem" class="inline-block pl-2 mr-2 self-center flex-none text-green-600"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"></path></svg><div class="text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Exercise 1: Linear Regression for the M-sigma Relation</div></div><div class="px-4 py-1"><p>We will apply the concept of linear regression to analyze the M-sigma relation using observational data. We have provided a dataset containing measurements of black hole masses (M_bh), velocity dispersions (sigma), and their associated uncertainties. Your task is to perform linear regression to fit both the black hole mass as a function of velocity dispersion (M_bh vs. sigma) and velocity dispersion as a function of black hole mass (sigma vs. M_bh).</p><ol start="1"><li><p><strong>Load the Data</strong>: Read the <code>m-sigma</code> dataset sent in Slack into a Pandas dataframe and inspect the first few rows to familiarize yourself with the structure of the data.</p></li><li><p><strong>Plot the Data</strong>: Create a scatter plot of the log of the black hole mass (log(M_bh)) against velocity dispersion (sigma), with error bars representing the uncertainties in both quantities.</p></li><li><p><strong>Perform Linear Regression</strong>:</p><ul><li>Fit a linear regression model to the data, treating M_bh as the dependent variable (y) and sigma as the independent variable (x) and incorporate the errors on sigma in the fit</li><li>Fit another linear regression model, treating sigma as the dependent variable (y) and M_bh as the independent variable (x) and incorporate the errors on M_bh in the fit.<details class="my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden rounded border-l-4 border-green-600"><summary class="m-0 font-medium py-1 flex min-w-0 text-lg text-green-600 bg-green-50 dark:bg-slate-900 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03]"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="2rem" height="2rem" class="inline-block pl-2 mr-2 self-center flex-none text-green-600"><path stroke-linecap="round" stroke-linejoin="round" d="M12 18v-5.25m0 0a6.01 6.01 0 001.5-.189m-1.5.189a6.01 6.01 0 01-1.5-.189m3.75 7.478a12.06 12.06 0 01-4.5 0m3.75 2.383a14.406 14.406 0 01-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 10-7.517 0c.85.493 1.509 1.333 1.509 2.316V18"></path></svg><div class="text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Hint: Incorporating Errors</div><div class="self-center flex-none text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="2rem" height="2rem" class="inline-block pl-2 mr-2 self-center flex-none transition-transform details-toggle"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></div></summary><div class="px-4 py-1 details-body"><p>Look into the weights keyword argument for <code>np.polyfit</code> to figure out how to incorporate errors.</p></div></details></li></ul></li><li><p><strong>Visualize the Results</strong>: Plot the regression lines along with the data points to observe how well they fit the M-sigma relation. Compare the slopes and intercepts of the regression lines for both fits.</p></li></ol></div></aside></div><div id="Ua8IemsqmX" class="relative group/block article-grid subgrid-gap col-screen"><h1 id="so-how-can-we-incapsulate-uncertainty-in-the-fitted-parameters" class="relative group"><span class="heading-text">So, how can we incapsulate uncertainty in the fitted parameters?</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#so-how-can-we-incapsulate-uncertainty-in-the-fitted-parameters" title="Link to this Section" aria-label="Link to this Section">¶</a></h1><p>As we can see, fitting the dispersion as a function of black hole mass, weighting by the uncertainties in velocity dispersion (and ignoring uncertainties in M_bh) produced a different fit! It should be clear then that we are not done — and that neither of these fits are likely well characterized in terms of the uncertainties in the data.</p><p>There are many ways to deal with this problem, including higher-complexity fits that include uncertainties in both x and y. One different, but conceptually simpler way we can estimate our uncertainty in the parameters of the fit (slope and intercept) is via <strong>bootstrap resampling or perturbative re-fitting</strong>.</p><h2 id="bootstrap-resampling" class="relative group"><span class="heading-text">Bootstrap Resampling</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#bootstrap-resampling" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Bootstrapping is a resampling technique used in statistics to estimate the sampling distribution of a statistic by repeatedly sampling with replacement from the observed data. It is particularly useful when the underlying population distribution is unknown or difficult to model.</p><ol start="1"><li>Sample Creation: Bootstrapping starts with the creation of multiple bootstrap samples by randomly selecting observations from the original dataset with replacement. This means that each observation in the original dataset has the same chance of being selected for each bootstrap sample, and some observations may be selected multiple times while others may not be selected at all.</li><li>Statistical Estimation: After creating the bootstrap samples, the statistic of interest (e.g., mean, median, standard deviation, regression coefficient) is calculated for each bootstrap sample. This results in a distribution of the statistic across the bootstrap samples, known as the bootstrap distribution. In our case, this would be fitting our line to the data and seeing how much the paramters (slope and intercept) change for each fit. Now, we have some way of expressing uncertainty in our fitted parameters!
<img style="margin:0 auto" src="/build/bootstrap_resampling-19edf9abbf7bf206cfe7896795c20131.png" data-canonical-url="bootstrap_resampling.png"/>
On Wednesday, we will start with an exercise using bootstrapping to estimate the uncertainty on our fit for the M-sigma relation!</li></ol></div><div id="ypv4cVqzpn" class="relative group/block article-grid subgrid-gap col-screen"><h1 id="what-about-fitting-arbitrary-functions" class="relative group"><span class="heading-text">What about fitting arbitrary functions?</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#what-about-fitting-arbitrary-functions" title="Link to this Section" aria-label="Link to this Section">¶</a></h1><p>Everything we’ve done so far pertains to fitting polynomials to data, but what if you want to fit a differnt type of function (like a Gaussian distribution)? We will go into this on Wednesday!</p></div><div class="flex pt-10 mb-10 space-x-4"><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/pandas"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="text-xs text-gray-500 dark:text-gray-400">Week  5</div>Pandas</div></div></a><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/hunt"><div class="flex h-full align-middle"><div class="flex-grow"><div class="text-xs text-gray-500 dark:text-gray-400">Week  1</div>Unix Scavenger Hunt!</div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3"></path></svg></div></a></div></main></article><script>((l,d)=>{if(!window.history.state||!window.history.state.key){let f=Math.random().toString(32).slice(2);window.history.replaceState({key:f},"")}try{let p=JSON.parse(sessionStorage.getItem(l)||"{}")[d||window.history.state.key];typeof p=="number"&&window.scrollTo(0,p)}catch(f){console.error(f),sessionStorage.removeItem(l)}})("positions", null)</script><link rel="modulepreload" href="/build/entry.client-K6EYMIDZ.js"/><link rel="modulepreload" href="/build/_shared/chunk-FBLNPC3V.js"/><link rel="modulepreload" href="/build/_shared/chunk-XJN3BT5Q.js"/><link rel="modulepreload" href="/build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="/build/_shared/chunk-JPGYAJQ3.js"/><link rel="modulepreload" href="/build/_shared/chunk-YAIQ7LUU.js"/><link rel="modulepreload" href="/build/_shared/chunk-JOLZ6LZB.js"/><link rel="modulepreload" href="/build/_shared/chunk-XIW7RL3H.js"/><link rel="modulepreload" href="/build/_shared/chunk-I634YBN3.js"/><link rel="modulepreload" href="/build/_shared/chunk-MITWS4PZ.js"/><link rel="modulepreload" href="/build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="/build/_shared/chunk-M5ZDOVXY.js"/><link rel="modulepreload" href="/build/_shared/chunk-6TYLRLOL.js"/><link rel="modulepreload" href="/build/_shared/chunk-UZHI4RYQ.js"/><link rel="modulepreload" href="/build/_shared/chunk-RTIGS2T3.js"/><link rel="modulepreload" href="/build/root-2CYAF5SQ.js"/><link rel="modulepreload" href="/build/_shared/chunk-OYK7WRH2.js"/><link rel="modulepreload" href="/build/routes/$-ZDWRJY4B.js"/><script>window.__remixContext = {"url":"/week8-linear-regression","state":{"loaderData":{"root":{"theme":"light","config":{"title":"Astro RPS","options":{"logo":"/build/astro-rps-logo-5e1744e2e1dba761340324e371f9a0e6.webp"},"myst":"1.1.37","nav":[],"actions":[],"projects":[{"title":"Astro RPS","github":"https://astro-rps.github.io/","keywords":[],"thumbnail":"/build/astro-rps-header-git-a93200a8cc2b5d8ab2d12eb69452df7a.png","exports":[],"bibliography":[],"index":"readme","pages":[{"slug":"topiclist","title":"Course Topics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"title":"Lectures","level":1},{"title":"Week  1","level":2},{"slug":"intro","title":"Welcome to the Astro Research Preparation Series!","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"unix","title":"Introduction to UNIX and Filesystems: Navigating and Managing Data","description":"","date":"","thumbnail":"/build/finder-5c14a1ea67fb2a5082eb3c298369552b.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"environments","title":"The Python Ecosystem and Virtual Environments","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Week  2","level":2},{"slug":"first-python-codes","title":"First Python Codes","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"variables-datatypes","title":"A Deep Dive into Variables and Datatypes","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"numpy-and-arrays","title":"Numpy and Arrays","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Week  3","level":2},{"slug":"import-lecture","title":"Introduction to Imports","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"logic-lecture","title":"Logic Flow and Error Parsing","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"loop-lecture","title":"Looping in Python","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Week  4","level":2},{"slug":"functions","title":"Functions in Python","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Week  5","level":2},{"slug":"pandas","title":"Pandas","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Week  8","level":2},{"slug":"week8-linear-regression","title":"Introduction to Inference in Astronomy: Fitting Models to Data","description":"","date":"","thumbnail":"/build/bootstrap_resampling-19edf9abbf7bf206cfe7896795c20131.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Labs","level":1},{"title":"Week  1","level":2},{"slug":"hunt","title":"Unix Scavenger Hunt!","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Week  2","level":2},{"slug":"week2-assignment","title":"Calculating the Luminosities of Stars","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Week  3","level":2},{"slug":"assignment-w3","title":"Week 3 Assignment","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Week  4","level":2},{"slug":"week4","title":"Week 4 Exercises","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Week  5","level":2},{"slug":"assignment-functions","title":"Functions (and HII regions in M33)","description":"","date":"","thumbnail":"/build/eagle-ade9779fab06ef18b8a3a7eb705cc974.jpg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Week  6","level":2},{"slug":"week6-lab","title":"Astro-RPS Week 6 Lab: Practice with Notebook, Pandas, and Plotting!","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Week  7","level":2},{"slug":"rps-week7-exoplanets","title":"Astro-RPS Week 7 Lab:  Exploring the Diversity of Known Exoplanets","description":"","date":"","thumbnail":"/build/Mass-separation-plot-3ea344c33adb20b08be5a92a143f829e.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Week  8","level":2},{"slug":"bootstrapping-lab","title":"Fitting Models to Data: Bootstrapping","description":"","date":"","thumbnail":"/build/bootstrap_resampling-7ec0da12281d7c1bce988260308d21fe.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"gaussian-lab","title":"Moving beyond polynomials: Fitting arbitrary functions","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static"},"routes/$":{"page":{"kind":"Notebook","sha256":"2e66ef90d1162f7c98a2af22c824aaaf3f0a2bd5cad9dad3b32aaf05fc063042","slug":"week8-linear-regression","location":"/01_Lectures/Week 8/week8_linear_regression.ipynb","dependencies":[],"frontmatter":{"title":"Introduction to Inference in Astronomy: Fitting Models to Data","github":"https://astro-rps.github.io/","keywords":[],"thumbnail":"/build/bootstrap_resampling-19edf9abbf7bf206cfe7896795c20131.png","exports":[{"format":"ipynb","filename":"week8_linear_regression.ipynb","url":"/build/week8_linear_regress-d17bd27e8bb7def29ce3a5b282865361.ipynb"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Today, we’ll explore what data science entails, the importance of model fitting and how we can apply it in astronomical data analysis, and the role of inference in drawing meaningful conclusions from our observations.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aY1vjiQZiR"}],"key":"k6WaI3EzaE"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Inference refers to the process of comparing models to data and is a fundamental aspect of data analysis in astronomy. In the context of astronomy, model fitting enables us to extract valuable information about the physical properties of objects (like stars, galaxies, exoplanets, etc) by comparing observational data to theoretical models or mathematical functions.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"tuaufB8OK8"}],"key":"Gd972skY24"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"This notebook will cover two of the most fundamental models with use in astronomy: lines and gaussian curves.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Msn3qPEqAu"}],"key":"lzlWALzOJH"}],"data":{"type":"notebook-content"},"key":"thahRKJJeh"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Linear Regression:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ooFk8p1dwa"}],"identifier":"linear-regression","label":"Linear Regression:","html_id":"linear-regression","implicit":true,"key":"KDov0SgPYv"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Linear regression just means “let’s fit a line”! It’s a statistical method used to model the relationship between a dependent variable (often denoted as ‘y’) and one or more independent variables (often denoted as ‘x’). It assumes that the relationship between the variables can be described by a linear equation, such as a straight line in the case of simple linear regression. Like an inference task, the goal of linear regression is to find the best-fitting line that minimizes the differences between the observed values and the values predicted by the model.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kDM6wtSGeE"}],"key":"SaSqZ2FgGd"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"For the simpliest case of a straight line, aka a first order polynomial, we can describe our model using two parameters: ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"FMRwWkpA4p"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"slope","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"VN07ERXdcH"}],"key":"YQcPTBSSy0"},{"type":"text","value":" and ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xYtP0PpjIL"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"intercept","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"I369JPH8KL"}],"key":"KMLJ8FAu0o"},{"type":"text","value":".","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"MOLGyUtqP6"}],"key":"G05zj2rTXd"}],"data":{"type":"notebook-content"},"key":"i0PjWzQasN"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"How can we implement this in python?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gCDrkOL4WU"}],"identifier":"how-can-we-implement-this-in-python","label":"How can we implement this in python?","html_id":"how-can-we-implement-this-in-python","implicit":true,"key":"FuvMq5Sgr3"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"inlineCode","value":"np.polyfit","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hEm9JNlx5m"},{"type":"text","value":" is a function in NumPy used for polynomial regression, which fits a polynomial curve to a set of data points. In the context of linear regression, ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"S0uPDV2wYz"},{"type":"inlineCode","value":"np.polyfit","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AsW6U8tAM6"},{"type":"text","value":" fits a polynomial of degree 1 (a straight line) to the given data points by minimizing the sum of squared errors between the observed and predicted values. This function returns the coefficients of the polynomial that best fits the data, allowing us to determine the slope and intercept of the regression line.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hZZEG7d9qj"}],"key":"PuNogGewGJ"}],"data":{"type":"notebook-content"},"key":"WhyX3WNWIJ"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\n\n# Generate fake data for demonstration\nx = np.array([1, 2, 3, 4, 5])\ny = np.array([2.1, 3.9, 5.8, 8.2, 10.1])","key":"Nps1ByEzxr"},{"type":"output","id":"skzH0qcuMFALwlVG4aYlq","data":[],"key":"tPrn65QJaX"}],"data":{"type":"notebook-code"},"key":"SikNGxvpSN"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"# Fit a straight line (polynomial of degree 1) to the data\ncoefficients = np.polyfit(x, y, deg=1)\ncoefficients","key":"xR0D0th26d"},{"type":"output","id":"pjyyeFXYfS_IqopB6AW_s","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"array([ 2.03, -0.07])","content_type":"text/plain"}}}],"key":"WKOlkbzTXU"}],"data":{"type":"notebook-code"},"key":"L9twhWvNAb"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"# Extract the slope (m) and intercept (b) from the coefficients\nslope, intercept = coefficients\n# note: you can do this more efficiently by just writing: slope, intercept = np.polyfit(x, y, deg=1),\n# but I wanted to print coefficients to show the actual output of polyfit\n\n# Print the equation of the fitted line\nprint(f\"Fitted line equation: y = {slope:.2f}x + {intercept:.2f}\")","key":"Bu7dejMRWF"},{"type":"output","id":"Dc54uC8AFCaE7AeiEwZnE","data":[{"name":"stdout","output_type":"stream","text":"Fitted line equation: y = 2.03x + -0.07\n"}],"key":"EA1WyQsG58"}],"data":{"type":"notebook-code"},"key":"VqcF3EjEl4"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"So we have managed to fit a line to our data! Horray! Now let’s plot both the data and model:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AaJscQu3jP"}],"key":"vvkrCaTUjU"}],"data":{"type":"notebook-content"},"key":"lLJNE61vWp"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"# Generate points along the fitted line for plotting\nx_fit = np.linspace(min(x), max(x), 100)\ny_fit = slope * x_fit + intercept\n\n# Plot the data points and the fitted line\nplt.figure(figsize=(8, 6))\nplt.scatter(x, y, color=\"blue\", label=\"Data\")\nplt.plot(x_fit, y_fit, color=\"red\", label=\"Fitted Line\")\nplt.xlabel(\"x\", fontsize=14)\nplt.ylabel(\"y\", fontsize=14)\nplt.legend()\nplt.show()","key":"YPhG8xMbBG"},{"type":"output","id":"3hJHLo0s8ryvJensZxCbo","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"df23e494163385452b38e8f50d5e57f1","path":"/build/df23e494163385452b38e8f50d5e57f1.png"},"text/plain":{"content":"\u003cFigure size 800x600 with 1 Axes\u003e","content_type":"text/plain"}}}],"key":"ybbylFineO"}],"data":{"type":"notebook-code"},"key":"oTxqQCmqK1"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"A practical astronomy application: The M-sigma Relation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZdKrhZcxEr"}],"identifier":"a-practical-astronomy-application-the-m-sigma-relation","label":"A practical astronomy application: The M-sigma Relation","html_id":"a-practical-astronomy-application-the-m-sigma-relation","implicit":true,"key":"FyYDooIIpE"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The M-sigma relation, also known as the black hole mass-velocity dispersion relation, is an empirical correlation observed between the mass of supermassive black holes (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Eaq1jh3WKP"},{"type":"inlineMath","value":"M_{bh}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003eM\u003c/mi\u003e\u003cmrow\u003e\u003cmi\u003eb\u003c/mi\u003e\u003cmi\u003eh\u003c/mi\u003e\u003c/mrow\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eM_{bh}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10903em;\"\u003eM\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3361em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ebh\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"ko1NLD6KeJ"},{"type":"text","value":") at the centers of galaxies and the velocity dispersion (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kxPyx47ynv"},{"type":"text","value":"σ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CNXPIFE9hx"},{"type":"text","value":") of stars in the bulges of those galaxies. This relationship suggests that there is a tight connection between the properties of galaxies and the central black holes they host. Specifically, galaxies with larger velocity dispersions tend to harbor more massive black holes at their centers.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KVO6SrOegv"}],"key":"ajAXKqI8tT"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The M-sigma relation has profound implications for our understanding of galaxy formation and evolution, as well as the co-evolution of galaxies and their central black holes. It provides valuable insights into the mechanisms governing the growth and regulation of supermassive black holes, the role of feedback processes in galaxy evolution, and the relationship between the properties of galactic bulges and their central black holes.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"R9tOzQM8LP"}],"key":"nyvqDgTJIS"}],"data":{"type":"notebook-content"},"key":"UcRmp9vinH"},{"type":"block","children":[{"type":"admonition","class":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Exercise 1: Linear Regression for the M-sigma Relation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DHIdvpum9T"}],"key":"UcXV70XXUO"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"We will apply the concept of linear regression to analyze the M-sigma relation using observational data. We have provided a dataset containing measurements of black hole masses (M_bh), velocity dispersions (sigma), and their associated uncertainties. Your task is to perform linear regression to fit both the black hole mass as a function of velocity dispersion (M_bh vs. sigma) and velocity dispersion as a function of black hole mass (sigma vs. M_bh).","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Xncqwd7lf4"}],"key":"feWMr6eIXi"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Load the Data","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"XZEZGnqaY0"}],"key":"esJoJ5IWrs"},{"type":"text","value":": Read the ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"CbMu2bET3i"},{"type":"inlineCode","value":"m-sigma","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"lfnzVoUKqf"},{"type":"text","value":" dataset sent in Slack into a Pandas dataframe and inspect the first few rows to familiarize yourself with the structure of the data.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Datf9AuYuB"}],"key":"Thtl68Dkao"}],"key":"RtZNIsjSEJ"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Plot the Data","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"BUEzHl9Wx4"}],"key":"Snyem2woKY"},{"type":"text","value":": Create a scatter plot of the log of the black hole mass (log(M_bh)) against velocity dispersion (sigma), with error bars representing the uncertainties in both quantities.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"tSkkSO2jjA"}],"key":"B0xFdI7Z0W"}],"key":"MFQEb9yngf"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Perform Linear Regression","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"L0p0tocCc3"}],"key":"IzNP216SzP"},{"type":"text","value":":","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"fErQtfe32Z"}],"key":"tg1Zegi7xt"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":11,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Fit a linear regression model to the data, treating M_bh as the dependent variable (y) and sigma as the independent variable (x) and incorporate the errors on sigma in the fit","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"i9QmXkSEhZ"}],"key":"CqusBuqrPn"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Fit another linear regression model, treating sigma as the dependent variable (y) and M_bh as the independent variable (x) and incorporate the errors on M_bh in the fit.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"tB74DmK2vD"},{"type":"admonition","kind":"hint","class":"dropdown","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Hint: Incorporating Errors","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"MS3NmPbE6t"}],"key":"TifQCOgdqB"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Look into the weights keyword argument for ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"nscpYCILMd"},{"type":"inlineCode","value":"np.polyfit","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"ijrnEkp7F2"},{"type":"text","value":" to figure out how to incorporate errors.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"j2SQjRwycA"}],"key":"LfrN54cdoJ"}],"key":"T6EF0S59mJ"}],"key":"pFizWFlfrN"}],"key":"mmOTo3iXVo"}],"key":"TVS3Kcy3zr"},{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"strong","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Visualize the Results","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"yJ0DR43EvC"}],"key":"DI5cHNj0qz"},{"type":"text","value":": Plot the regression lines along with the data points to observe how well they fit the M-sigma relation. Compare the slopes and intercepts of the regression lines for both fits.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"LCOEd6K9Gd"}],"key":"rWHpsvvMyE"}],"key":"n2bIXBf4Gz"}],"key":"MlwyBGl5bt"}],"key":"yu4oSnaB82"}],"data":{"type":"notebook-content"},"key":"EP65R6nE4E"},{"type":"block","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"So, how can we incapsulate uncertainty in the fitted parameters?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TVwity0SUy"}],"identifier":"so-how-can-we-incapsulate-uncertainty-in-the-fitted-parameters","label":"So, how can we incapsulate uncertainty in the fitted parameters?","html_id":"so-how-can-we-incapsulate-uncertainty-in-the-fitted-parameters","implicit":true,"key":"DnhAeAMjbh"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"As we can see, fitting the dispersion as a function of black hole mass, weighting by the uncertainties in velocity dispersion (and ignoring uncertainties in M_bh) produced a different fit! It should be clear then that we are not done — and that neither of these fits are likely well characterized in terms of the uncertainties in the data.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"H6ML6XQAjC"}],"key":"Rw0R9fZdZU"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"There are many ways to deal with this problem, including higher-complexity fits that include uncertainties in both x and y. One different, but conceptually simpler way we can estimate our uncertainty in the parameters of the fit (slope and intercept) is via ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"yvyoETQ9eB"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"bootstrap resampling or perturbative re-fitting","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Rsw9zeQi9W"}],"key":"zpljpS0kRY"},{"type":"text","value":".","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"GdWqZaCG5V"}],"key":"O4gxkxXlGH"},{"type":"heading","depth":2,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Bootstrap Resampling","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Aujm5eDuUv"}],"identifier":"bootstrap-resampling","label":"Bootstrap Resampling","html_id":"bootstrap-resampling","implicit":true,"key":"rm8Lp1qEpG"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Bootstrapping is a resampling technique used in statistics to estimate the sampling distribution of a statistic by repeatedly sampling with replacement from the observed data. It is particularly useful when the underlying population distribution is unknown or difficult to model.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"KYDhNN51Ue"}],"key":"sHAMhxWcv5"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":11,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Sample Creation: Bootstrapping starts with the creation of multiple bootstrap samples by randomly selecting observations from the original dataset with replacement. This means that each observation in the original dataset has the same chance of being selected for each bootstrap sample, and some observations may be selected multiple times while others may not be selected at all.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"LhYJsipucO"}],"key":"pjz075c48X"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Statistical Estimation: After creating the bootstrap samples, the statistic of interest (e.g., mean, median, standard deviation, regression coefficient) is calculated for each bootstrap sample. This results in a distribution of the statistic across the bootstrap samples, known as the bootstrap distribution. In our case, this would be fitting our line to the data and seeing how much the paramters (slope and intercept) change for each fit. Now, we have some way of expressing uncertainty in our fitted parameters!\n","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"bgt2ObDrpB"},{"type":"image","url":"/build/bootstrap_resampling-19edf9abbf7bf206cfe7896795c20131.png","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"S0ww4UCl4R","urlSource":"bootstrap_resampling.png"},{"type":"text","value":"\nOn Wednesday, we will start with an exercise using bootstrapping to estimate the uncertainty on our fit for the M-sigma relation!","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"Hu8XjGtKrW"}],"key":"csRN5UpnBv"}],"key":"ygjkhrU3UH"}],"data":{"type":"notebook-content"},"key":"Ua8IemsqmX"},{"type":"block","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"What about fitting arbitrary functions?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"A6fukj0s9x"}],"identifier":"what-about-fitting-arbitrary-functions","label":"What about fitting arbitrary functions?","html_id":"what-about-fitting-arbitrary-functions","implicit":true,"key":"ZE5qNRO7Tk"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Everything we’ve done so far pertains to fitting polynomials to data, but what if you want to fit a differnt type of function (like a Gaussian distribution)? We will go into this on Wednesday!","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cONq5LgrTP"}],"key":"UW0pSi3p0Y"}],"data":{"type":"notebook-content"},"key":"ypv4cVqzpn"}],"key":"FycSgiVszj"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Pandas","url":"/pandas","group":"Week  5"},"next":{"title":"Unix Scavenger Hunt!","url":"/hunt","group":"Week  1"}}},"domain":"http://localhost:3002"}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":false,"v2_headers":true,"v2_meta":false,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/build/manifest-FDC5A112.js";
import * as route0 from "/build/root-2CYAF5SQ.js";
import * as route1 from "/build/routes/$-ZDWRJY4B.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/build/entry.client-K6EYMIDZ.js");</script></body></html>